{
    "autosize": "none",
    "padding": 4,
    "resize": true,
    "width": 300,
    "height": 200,
    "config": {
      "arc": {"fill": "#000"},
      "area": {"fill": "#333333b5"},
      "line": {"stroke": "#333333b5"},
      "path": {"stroke": "#333333b5"},
      "shape": {"stroke": "#333333b5"},
      "symbol": {"fill": "#333333b5", "size": 40},
      "axis": {
        "domain": false,
        "gridColor": "#d5d5d5",
        "titleColor": "#333",
        "labelOverlap": "parity",
        "labelColor": "#333",
        "gridWidth": 1,
        "labelFontSize": {"signal": "AxisFontSize"},
        "labelPadding": 4,
        "tickColor": "#333333b5",
        "tickSize": 5.67,
        "titleFontSize": {"signal": "AxisTitle_Font"},
        "titleFontWeight": "bolder"
      },
      "title": {
        "fontSize": {"signal": "Title_Font"},
        "color": "#333",
        "fontWeight": "bolder",
        "subtitleColor": "#777"
      },
      "legend": {
        "labelBaseline": "middle",
        "labelFontSize": {"signal": "Legend_Font"},
        "columns": {"signal": "Legend_Cols"},
        "cornerRadius": 5,
        "padding": 5,
        "offset": {"signal": "-Legend_Height"},
        "symbolSize": 100
      }
    },
    "signals": [
      {
        "name": "X_Axis",
        "value": "flipper_length_mm",
        "bind": {
          "input": "select",
          "element": "#X_Axis-ccnm",
          "options": [
            "species",
            "island",
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None",
            "Sum",
            "Count"
          ]
        }
      },
      {
        "name": "Y_Axis",
        "value": "bill_length_mm",
        "bind": {
          "input": "select",
          "element": "#Y_Axis-ccnm",
          "options": [
            "species",
            "island",
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None",
            "Sum",
            "Count"
          ]
        }
      },
      {
        "name": "Size_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Size_By-ccnm",
          "options": [
            "species",
            "island",
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Facet_Cols_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Facet_Cols_By-ccnm",
          "options": [
            "species",
            "island",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Facet_Rows_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Facet_Rows_By-ccnm",
          "options": [
            "species",
            "island",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Color_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Color_By-ccnm",
          "options": [
            "species",
            "island",
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Opacity_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Opacity_By-ccnm",
          "options": ["None"]
        }
      },
      {
        "name": "SortX_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#SortX_By-ccnm",
          "options": ["None"]
        }
      },
      {
        "name": "Stroke_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Stroke_By-ccnm",
          "options": [
            "species",
            "island",
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {"name": "Stroke_Categories", "value": "None"},
      {
        "name": "Shape",
        "value": "circle",
        "bind": {
          "input": "select",
          "element": "#Shape-ccnm",
          "options": [
            "circle",
            "square",
            "cross",
            "diamond",
            "triangle-up",
            "triangle-down",
            "triangle-right",
            "triangle-left",
            "stroke",
            "arrow",
            "wedge",
            "triangle"
          ]
        }
      },
      {
        "name": "Filter_Out_From",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Filter_Out_From-ccnm",
          "options": [
            "species",
            "island",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Sum_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Sum_By-ccnm",
          "options": [
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "year",
            "None"
          ]
        }
      },
      {"name": "Export_CSV", "value": true},
      {"name": "graph_title", "value": ""},
      {
        "name": "AxisTitle_Font",
        "value": 12,
        "bind": {"element": "#AxisTitle_Font-ccnm", "input": "text"}
      },
      {
        "name": "Grid_Radius",
        "value": 1,
        "bind": {"element": "#Grid_Radius-ccnm", "input": "text"}
      },
      {
        "name": "Datatype_X",
        "value": "Auto",
        "bind": {
          "input": "select",
          "element": "#Datatype_X-ccnm",
          "options": ["Auto", "Numerical", "Categorical", "Date"]
        }
      },
      {
        "name": "Datatype_Y",
        "value": "Auto",
        "bind": {
          "input": "select",
          "element": "#Datatype_Y-ccnm",
          "options": ["Auto", "Numerical", "Categorical", "Date"]
        }
      },
      {
        "name": "Datatype_Color",
        "value": "Auto",
        "bind": {
          "input": "select",
          "element": "#Datatype_Color-ccnm",
          "options": ["Auto", "Numerical", "Categorical", "Date"]
        }
      },
      {
        "name": "Barplot_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Barplot-ccnm"}
      },
      {
        "name": "Uniform_YLim",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Uniform_YLim-ccnm"}
      },
      {
        "name": "Grid_Spacing",
        "value": true,
        "bind": {"input": "checkbox", "element": "#Grid_Spacing-ccnm"}
      },
      {
        "name": "X_Axis_Angle",
        "value": -90,
        "bind": {
          "element": "#X_Axis_Angle-ccnm",
          "input": "range",
          "min": -180,
          "max": 180,
          "step": 45
        }
      },
      {
        "name": "Y_Axis_Angle",
        "value": 0,
        "bind": {
          "element": "#Y_Axis_Angle-ccnm",
          "input": "range",
          "min": -180,
          "max": 180,
          "step": 45
        }
      },
      {
        "name": "Manual_Color",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Manual_Color-ccnm"}
      },
      {
        "name": "Min_Color",
        "value": "",
        "bind": {"element": "#Min_Color-ccnm", "input": "text"}
      },
      {
        "name": "Max_Color",
        "value": "",
        "bind": {"element": "#Max_Color-ccnm", "input": "text"}
      },
      {
        "name": "Y_Upper_Lim",
        "value": "",
        "bind": {"element": "#Y_Upper_Lim-ccnm", "input": "text"}
      },
      {
        "name": "Y_Lower_Lim",
        "value": "",
        "bind": {"element": "#Y_Lower_Lim-ccnm", "input": "text"}
      },
      {
        "name": "X_Upper_Lim",
        "value": "",
        "bind": {"element": "#X_Upper_Lim-ccnm", "input": "text"}
      },
      {
        "name": "X_Lower_Lim",
        "value": "",
        "bind": {"element": "#X_Lower_Lim-ccnm", "input": "text"}
      },
      {
        "name": "Jitter_Radius",
        "value": 1.25,
        "bind": {"element": "#Jitter_Radius-ccnm", "input": "text"}
      },
      {
        "name": "Violin_Opacity",
        "value": 0.15,
        "bind": {
          "element": "#Violin_Opacity-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.05
        }
      },
      {
        "name": "Grid_Opacity",
        "value": 1,
        "bind": {
          "element": "#Grid_Opacity-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.1
        }
      },
      {
        "name": "Cnt_St_Opacity",
        "value": 0.4,
        "bind": {
          "element": "#Cnt_St_Opacity-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.05
        }
      },
      {
        "name": "Contour_Opacity",
        "value": 0.4,
        "bind": {
          "element": "#Contour_Opacity-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.05
        }
      },
      {
        "name": "Dash_Opacity",
        "value": 0.5,
        "bind": {
          "element": "#Dash_Opacity-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.05
        }
      },
      {
        "name": "Boxplot_Opacity",
        "value": 0.4,
        "bind": {
          "element": "#Boxplot_Opacity-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.05
        }
      },
      {
        "name": "Stroke_Width",
        "value": 0.6,
        "bind": {
          "element": "#Stroke_Width-ccnm",
          "input": "range",
          "min": 0,
          "max": 8,
          "step": 0.01
        }
      },
      {
        "name": "TickCount",
        "value": 5,
        "bind": {"element": "#TickCount-ccnm", "input": "text"}
      },
      {
        "name": "Title_Font",
        "value": 14,
        "bind": {"element": "#Title_Font-ccnm", "input": "text"}
      },
      {
        "name": "Legend_Font",
        "value": 10,
        "bind": {"element": "#Legend_Font-ccnm", "input": "text"}
      },
      {
        "name": "Legend_Cols",
        "value": 6,
        "bind": {"element": "#Legend_Cols-ccnm", "input": "text"}
      },
      {
        "name": "AxisFontSize",
        "value": 10,
        "bind": {"element": "#AxisFontSize-ccnm", "input": "text"}
      },
      {
        "name": "Dash_Height",
        "value": 1,
        "bind": {"element": "#Dash_Height-ccnm", "input": "text"}
      },
      {
        "name": "Interactive_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Interactive_-ccnm"}
      },
      {
        "name": "Dash_Radius",
        "value": 0,
        "bind": {
          "element": "#Dash_Radius-ccnm",
          "input": "range",
          "min": 0,
          "max": 10,
          "step": 1
        }
      },
      {
        "name": "Dash_Width",
        "value": 0.25,
        "bind": {
          "element": "#Dash_Width-ccnm",
          "input": "range",
          "min": 0,
          "max": 5,
          "step": 0.01
        }
      },
      {
        "name": "Jitter_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Jitter_-ccnm"}
      },
      {
        "name": "Regression_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Regression_-ccnm"}
      },
      {
        "name": "Link",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Link-ccnm"}
      },
      {
        "name": "LinkField",
        "value": "",
        "bind": {"input": "text", "element": "#LinkField-ccnm"}
      },
      {
        "name": "LinkURL",
        "value": "",
        "bind": {"input": "text", "element": "#LinkURL-ccnm"}
      },
      {
        "name": "LinkTail",
        "value": "",
        "bind": {"input": "text", "element": "#LinkTail-ccnm"}
      },
      {
        "name": "Outliers_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Outliers_-ccnm"}
      },
      {
        "name": "Grids_",
        "value": true,
        "bind": {"input": "checkbox", "element": "#Grids-ccnm"}
      },
      {
        "name": "Dashes_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Dashes_-ccnm"}
      },
      {"name": "Map_XY_Cat_", "value": true},
      {
        "name": "Points_",
        "value": true,
        "bind": {"input": "checkbox", "element": "#Points_-ccnm"}
      },
      {
        "name": "Boxplot_",
        "value": true,
        "bind": {"input": "checkbox", "element": "#Boxplot_-ccnm"}
      },
      {
        "name": "Stats_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Stats_-ccnm"}
      },
      {
        "name": "Contours_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Contours_-ccnm"}
      },
      {"name": "col_header_fontsize", "value": 14},
      {
        "name": "Max_Point",
        "value": 100,
        "bind": {
          "element": "#Max_Point-ccnm",
          "input": "range",
          "min": 0,
          "max": 400,
          "step": 1
        }
      },
      {
        "name": "Min_Point",
        "value": 10,
        "bind": {
          "element": "#Min_Point-ccnm",
          "input": "range",
          "min": 0,
          "max": 100,
          "step": 0.1
        }
      },
      {
        "name": "Background_Color",
        "value": "#FFF",
        "bind": {"element": "#Background_Color-ccnm", "input": "text"}
      },
      {
        "name": "Include_Only",
        "value": " ",
        "bind": {"element": "#Include_Only-ccnm", "input": "text"}
      },
      {
        "name": "Search_By",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Search_By-ccnm",
          "options": [
          ]
        }
      },
      {
        "name": "Term",
        "value": "-",
        "bind": {"element": "#Term-ccnm", "input": "text"}
      },
      {
        "name": "Filter_If",
        "value": "-",
        "bind": {"element": "#Filter_If-ccnm", "input": "text"}
      },
      {
        "name": "filter_min",
        "value": "-1000000",
        "bind": {"element": "#filter_min-ccnm", "input": "text"}
      },
      {
        "name": "filter_max",
        "value": "1000000",
        "bind": {"element": "#filter_max-ccnm", "input": "text"}
      },
      {
        "name": "Filter_By_Value",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Filter_By_Value-ccnm",
          "options": [
            "bill_length_mm",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Filter_Additional",
        "value": "None",
        "bind": {
          "input": "select",
          "element": "#Filter_Additional-ccnm",
          "options": [
            "species",
            "island",
            "bill_depth_mm",
            "flipper_length_mm",
            "body_mass_g",
            "sex",
            "year",
            "None"
          ]
        }
      },
      {
        "name": "Violin_",
        "value": true,
        "bind": {"input": "checkbox", "element": "#Violin_-ccnm"}
      },
      {
        "name": "LogX_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#LogX_-ccnm"}
      },
      {
        "name": "LogY_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#LogY_-ccnm"}
      },
      {
        "name": "Palette",
        "value": "Magma",
        "bind": {
          "input": "select",
          "element": "#Palette-ccnm",
          "options": [
            "---Sequential---",
            "Turbo",
            "Cividis",
            "Viridis",
            "Magma",
            "Plasma",
            "Inferno",
            "Rainbow",
            "Plasma",
            "Blues",
            "Sinebow",
            "Reds",
            "Oranges",
            "BlueOrange",
            "BrownBlueGreen",
            "PurpleGreen",
            "PinkYellowGreen",
            "PurpleOrange",
            "RedBlue",
            "RedGrey",
            "RedYellowBlue",
            "RedYellowGreen",
            "darkblue",
            "darkgold",
            "darkred",
            "lightgreyred",
            "lightmulti",
            "spectral",
            "sinebow",
            "---Categorical---",
            "category20",
            "category10",
            "tableau10",
            "tableau20",
            "accent",
            "pastel1",
            "pastel2",
            "paired",
            "dark2"
          ]
        }
      },
      {"name": "Show_Titles", "value": true},
      {
        "name": "Reverse_Color",
        "value": true,
        "bind": {"input": "checkbox", "element": "#Reverse_Color-ccnm"}
      },
      {
        "name": "Reverse_X",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Reverse_X-ccnm"}
      },
      {
        "name": "Reverse_Y",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Reverse_Y-ccnm"}
      },
      {"name": "points", "value": true},
      {
        "name": "Reverse_Size",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Reverse_Size-ccnm"}
      },
      {
        "name": "Opacity_",
        "value": 0.8,
        "bind": {
          "element": "#Opacity_-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.05
        }
      },
      {
        "name": "Row_Header_Width",
        "value": 100,
        "bind": {
          "element": "#Row_Header_Width-ccnm",
          "input": "range",
          "min": 0,
          "max": 200,
          "step": 5
        }
      },
      {
        "name": "Title_Height",
        "value": 40,
        "bind": {
          "element": "#Title_Height-ccnm",
          "input": "range",
          "min": 0,
          "max": 200,
          "step": 5
        }
      },
      {
        "name": "Legend_Height",
        "value": 80,
        "bind": {
          "element": "#Legend_Height-ccnm",
          "input": "range",
          "min": 0,
          "max": 200,
          "step": 5
        }
      },
      {
        "name": "Max_Plot_Height",
        "value": 400,
        "bind": {
          "element": "#Max_Plot_Height-ccnm",
          "input": "range",
          "min": 50,
          "max": 3000,
          "step": 50
        }
      },
      {"name": "PlotTitle_Height", "value": 0},
      {
        "name": "X_Axis_Height",
        "value": 125,
        "bind": {
          "element": "#X_Axis_Height-ccnm",
          "input": "range",
          "min": 0,
          "max": 200,
          "step": 5
        }
      },
      {
        "name": "Plot_Padding",
        "value": 8,
        "bind": {
          "element": "#Plot_Padding-ccnm",
          "input": "range",
          "min": 0,
          "max": 40,
          "step": 1
        }
      },
      {
        "name": "Max_Plot_Width",
        "value": 800,
        "bind": {
          "element": "#Max_Plot_Width-ccnm",
          "input": "range",
          "min": 50,
          "max": 3000,
          "step": 50
        }
      },
      {
        "name": "Row_Height",
        "value": 150,
        "bind": {"element": "#Row_Height-ccnm", "input": "text"}
      },
      {
        "name": "Max_Facets",
        "value": 200,
        "bind": {"element": "#Max_Facets-ccnm", "input": "text"}
      },
      {
        "name": "Histogram_",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Histogram_-ccnm"}
      },
      {
        "name": "Histogram_Bins_Size",
        "value": 20,
        "bind": {"element": "#Histogram_Bins_Size-ccnm", "input": "text"}
      },
      {
        "name": "Violin_Width",
        "value": 0.8,
        "bind": {
          "element": "#Violin_Width-ccnm",
          "input": "range",
          "min": 0,
          "max": 1,
          "step": 0.1
        }
      },
      {
        "name": "Histogram_Ratio",
        "value": 0.25,
        "bind": {"element": "#Histogram_Ratio-ccnm", "input": "text"}
      },
      {
        "name": "Hist_Scatter_Ratio",
        "update": "if(Histogram_,Histogram_Ratio,0)"
      },
      {
        "name": "Column_Width",
        "update": "if((width-Row_Header_Width)/cols_count>Max_Plot_Width,Max_Plot_Width,(width-Row_Header_Width)/cols_count)"
      },
      {"name": "Plot_Width", "update": "Column_Width-Plot_Padding*2"},
      {
        "name": "margin_hz",
        "update": "max(0,(width-Column_Width*cols_count-Row_Header_Width)/2)"
      },
      {
        "name": "Plot_Height",
        "update": "if(rows_count>1,Row_Height-Plot_Padding,max(Max_Plot_Height-Plot_Padding,20))"
      },
      {"name": "row_ht", "update": "Plot_Height+Plot_Padding"},
      {
        "name": "legend_variable_height",
        "update": "if(!show_stacked_graphs&&!show_box_graphs&&!show_hzbox_graphs&&!show_grid_graphs&&!show_hist_graph&&!show_scatter_graph,data('columns').length*100,0)"
      },
      {
        "name": "height",
        "update": "if(show_explorer,width*1.1,if(rows_count>1,rows_count*Row_Height+Title_Height+Legend_Height+PlotTitle_Height+X_Axis_Height,Max_Plot_Height+Title_Height+Legend_Height+PlotTitle_Height+X_Axis_Height+legend_variable_height))"
      },
      {"name": "StrokeWidth", "value": 2},
      {
        "name": "Xord",
        "update": "data('X_type').length>0?data('X_type')[0].type=='num'?false:true:true"
      },
      {
        "name": "Yord",
        "update": "data('Y_type').length>0?data('Y_type')[0].type=='num'?false:true:true"
      },
      {
        "name": "Cord",
        "update": "data('Color_type').length>0?data('Color_type')[0].type=='num'?false:true:true"
      },
      {"name": "fail", "update": "length(data('cols_domain'))>Max_Facets"},
      {"name": "colors_count", "update": "length(data('colors_domain'))"},
      {"name": "cols_count", "update": "length(data('cols_domain'))"},
      {"name": "rows_count", "update": "length(data('rows_domain'))"},
      {
        "name": "clickedFilter",
        "value": null,
        "on": [
          {
            "events": "@filterLegendlab:click, @filterLegendlab2:click",
            "update": "{value: datum.value}",
            "force": true
          }
        ]
      },
      {
        "name": "show_explorer",
        "update": "!show_stacked_graphs&&!show_box_graphs&&!show_hzbox_graphs&&!show_grid_graphs&&!show_hist_graph&&!show_scatter_graph"
      },
      {
        "name": "show_box_graphs",
        "update": "Xord && !Yord && (Y_Axis != 'None' && Y_Axis != 'Count' && Y_Axis != 'Sum') && !fail"
      },
      {
        "name": "Show_Covariance",
        "value": false,
        "bind": {"input": "checkbox", "element": "#Show_Covariance-ccnm"}
      },
      {
        "name": "show_hzbox_graphs",
        "update": "Yord && (X_Axis != 'None' && X_Axis != 'Count' && X_Axis != 'Sum') && !Xord && !fail && (Y_Axis != 'None' && Y_Axis != 'Count' && Y_Axis != 'Sum')"
      },
      {
        "name": "show_stacked_graphs",
        "update": "Xord && (Y_Axis == 'None' || Y_Axis == 'Count' || Y_Axis == 'Sum')  && !fail && (X_Axis != 'None' && X_Axis != 'Count' && X_Axis != 'Sum')"
      },
      {"name": "steps", "value": 30},
      {
        "name": "viol_width",
        "update": "Violin_Width*Plot_Width / length(data('xcat_domain'))"
      },
      {
        "name": "viol_ht",
        "update": "Violin_Width*Plot_Height / length(data('ycat_domain'))"
      },
      {
        "name": "Hist_Scatter_Ratio2",
        "update": "if((Y_Axis != 'None' && Y_Axis != 'Count' && Y_Axis != 'Sum'),Hist_Scatter_Ratio,1)"
      },
      {
        "name": "show_hist_graph",
        "update": "(!Yord&&!Xord && Hist_Scatter_Ratio2!=0 && (Y_Axis != 'None' || Y_Axis != 'Count' || Y_Axis != 'Sum')) || ((Y_Axis != 'None' || Y_Axis != 'Count' || Y_Axis != 'Sum') && !Xord)"
      },
      {
        "name": "show_scatter_graph",
        "update": "!Xord && Hist_Scatter_Ratio2!=1 && !Yord && (Y_Axis != 'None' && Y_Axis != 'Count' && Y_Axis != 'Sum')"
      },
      {
        "name": "show_grid_graphs",
        "update": "Xord && Yord && (Y_Axis != 'None' && Y_Axis != 'Count' && Y_Axis != 'Sum') && !fail && Map_XY_Cat_"
      },
      {"name": "bandwidth", "value": -1},
      {"name": "resolve", "value": "independent"},
      {"name": "TitleText", "value": ""},
      {"name": "graph_sum_vars", "value": 0},
      {
        "name": "hist_graph_height",
        "update": "Plot_Height*(Hist_Scatter_Ratio2)"
      },
      {"name": "scatter_graph_height", "update": "Plot_Height-hist_graph_height"},
      {"name": "xcur", "value": null},
      {"name": "ycur", "value": null},
      {"name": "delta", "value": [0, 0]},
      {"name": "anchor", "value": [0, 0]},
      {"name": "zoom", "value": 1},
      {"name": "dist1", "value": 0},
      {"name": "dist2", "value": 0},
      {
        "name": "xdom",
        "update": "if(X_Upper_Lim!=''&X_Lower_Lim!='',[toNumber(X_Lower_Lim),toNumber(X_Upper_Lim)],[X_maxmin_num[0],X_maxmin_num[1]+0.05*(X_maxmin_num[1]-X_maxmin_num[0])])"
      },
      {
        "name": "ydom",
        "update": "if(Y_Upper_Lim!=''&Y_Lower_Lim!='',[toNumber(Y_Lower_Lim),toNumber(Y_Upper_Lim)],[Y_maxmin_num[0],Y_maxmin_num[1]+0.05*(Y_maxmin_num[1]-Y_maxmin_num[0])])"
      },
      {"name": "down", "value": null}
    ],
    "data": [
      {
        "name": "mycolumns",
        "values": [         
        ]
      },
      {
        "name": "col_names",
        "values": [         
        ]
      },
      {
        "name": "explorer_columns",
        "source": "mycolumns",
        "transform": [{"type": "filter", "expr": "show_explorer"}]
      },
      {
        "name": "X_type",
        "source": "mycolumns",
        "transform": [
          {"type": "filter", "expr": "datum.feature==X_Axis"},
          {
            "type": "formula",
            "as": "type",
            "expr": "Datatype_X=='Auto'?datum.type:Datatype_X"
          }
        ]
      },
      {
        "name": "Y_type",
        "source": "mycolumns",
        "transform": [
          {"type": "filter", "expr": "datum.feature==Y_Axis"},
          {
            "type": "formula",
            "as": "type",
            "expr": "Datatype_Y=='Auto'?datum.type:Datatype_Y"
          }
        ]
      },
      {
        "name": "Color_type",
        "source": "mycolumns",
        "transform": [
          {"type": "filter", "expr": "datum.feature==Color_By"},
          {
            "type": "formula",
            "as": "type",
            "expr": "Datatype_Color=='Auto'?datum.type:Datatype_Color"
          }
        ]
      },
      {
        "name": "covariance",
        "values": [],
        "transform": [{"type": "filter", "expr": "Show_Covariance"}]
      },
      {
        "name": "mydata",
        "transform": [
          {"type": "formula", "as": "None", "expr": "'None'"},
          {"type": "filter", "expr": "!Show_Covariance"},
          {
            "type": "formula",
            "as": "Count",
            "expr": "Sum_By=='None'?1:datum.Sum_By==0||datum.Sum_By=='0'?0:toNumber(datum[Sum_By])>0?toNumber(datum[Sum_By]):0"
          },
          {
            "type": "formula",
            "as": "X_Value",
            "expr": "Datatype_X=='Auto'?datum[X_Axis]:Datatype_X=='Numerical'?toNumber(datum[X_Axis]):Datatype_X=='Categorical'?toString(datum[X_Axis]):Datatype_X=='Date'?toDate(datum[X_Axis]):datum[X_Axis]"
          },
          {
            "type": "formula",
            "as": "Y_Value",
            "expr": "Datatype_Y=='Auto'?datum[Y_Axis]:Datatype_Y=='Numerical'?toNumber(datum[Y_Axis]):Datatype_Y=='Categorical'?toString(datum[Y_Axis]):Datatype_Y=='Date'?toDate(datum[Y_Axis]):datum[Y_Axis]"
          },
          {
            "type": "filter",
            "expr": "X_Axis=='None'|| ((X_Axis != 'None' && X_Axis != 'Count' && X_Axis != 'Sum') && !(!isValid(datum[X_Axis]) || datum[X_Axis]==Filter_If || datum[X_Axis] =='NA' || datum[X_Axis] =='null' || datum[X_Axis] =='NaN' || datum[X_Axis] =='N/A'))"
          },
          {
            "type": "filter",
            "expr": "(Y_Axis == 'None' || Y_Axis == 'Count' || Y_Axis == 'Sum') || (Y_Axis != 'None' && !(!isValid(datum[Y_Axis]) || datum[Y_Axis]==Filter_If || datum[Y_Axis] =='NA' || datum[Y_Axis] =='null' || datum[Y_Axis] =='NaN' || datum[Y_Axis] =='N/A'))"
          },
          {
            "type": "filter",
            "expr": "Facet_Rows_By == 'None' || (Facet_Rows_By != 'None' && !(!isValid(datum[Facet_Rows_By]) || datum[Facet_Rows_By]==Filter_If || datum[Facet_Rows_By] =='NA' || datum[Facet_Rows_By] =='null' || datum[Facet_Rows_By] =='NaN' || datum[Facet_Rows_By] =='N/A'))"
          },
          {
            "type": "filter",
            "expr": "Facet_Cols_By == 'None' || (Facet_Cols_By != 'None' && !(!isValid(datum[Facet_Cols_By]) || datum[Facet_Cols_By]==Filter_If || datum[Facet_Cols_By] =='NA' || datum[Facet_Cols_By] =='null' || datum[Facet_Cols_By] =='NaN' || datum[Facet_Cols_By] =='N/A'))"
          },
          {
            "type": "filter",
            "expr": "Color_By == 'None' || (Color_By != 'None' && !(!isValid(datum[Color_By]) || datum[Color_By]==Filter_If || datum[Color_By] =='NA' || datum[Color_By] =='null' || datum[Color_By] =='NaN' || datum[Color_By] =='N/A'))"
          },
          {
            "type": "filter",
            "expr": "Size_By == 'None' || (Size_By != 'None' && !(!isValid(datum[Size_By]) || datum[Size_By]==Filter_If || datum[Size_By] =='NA' || datum[Size_By] =='null' || datum[Size_By] =='NaN' || datum[Size_By] =='N/A'))"
          },
          {"type": "formula", "as": "SortX_Value", "expr": "datum[SortX_By]"},
          {"type": "formula", "as": "Term", "expr": "datum[Search_By]"},
          {"type": "formula", "as": "Stroke_Value", "expr": "datum[Stroke_By]"},
          {"type": "formula", "as": "Col_Value", "expr": "datum[Facet_Cols_By]"},
          {"type": "formula", "as": "Color_Value", "expr": "datum[Color_By]"},
          {"type": "formula", "as": "O_Value", "expr": "datum[Opacity_By]"},
          {"type": "formula", "as": "Row_Value", "expr": "datum[Facet_Rows_By]"},
          {
            "type": "formula",
            "as": "Size_Value",
            "expr": "if(isFinite(toNumber(datum[Size_By])),toNumber(datum[Size_By]),Max_Point)"
          }
        ],
        "values": []
      },
      {
        "name": "selectedFilter",
        "on": [{"trigger": "clickedFilter", "toggle": "clickedFilter"}]
      },
      {
        "name": "selectedFilter2",
        "on": [{"trigger": "clickedFilter", "toggle": "clickedFilter"}]
      },
      {
        "name": "tdata",
        "source": "mydata",
        "transform": [
          {"type": "filter", "expr": "!Yord&LogY_ & datum.Y_Value<=0?false:true"},
          {"type": "filter", "expr": "!Xord&LogX_ & datum.X_Value<=0?false:true"},
          {
            "type": "filter",
            "expr": "!indata('selectedFilter', 'value', datum[Filter_Out_From])"
          },
          {
            "type": "filter",
            "expr": "!indata('selectedFilter2', 'value', datum[Filter_Additional])"
          },
          {
            "type": "filter",
            "expr": "if(Filter_By_Value!='None',if(datum[Filter_By_Value]>=toNumber(filter_min)&datum[Filter_By_Value]<=toNumber(filter_max),true,false),true)"
          },
          {"type": "extent", "field": "Y_Value", "signal": "Y_maxmin_num"},
          {"type": "extent", "field": "X_Value", "signal": "X_maxmin_num"},
          {"type": "extent", "field": "Color_Value", "signal": "C_maxmin_num"},
          {"type": "extent", "field": "Size_Value", "signal": "S_maxmin_num"}
        ]
      },
      {
        "name": "colors_domain",
        "source": "tdata",
        "transform": [
          {"type": "collect", "sort": {"field": "Color_Value"}},
          {"type": "aggregate", "groupby": ["Color_Value"]}
        ]
      },
      {
        "name": "stroke_domain",
        "source": "tdata",
        "transform": [
          {"type": "collect", "sort": {"field": "Stroke_Value"}},
          {"type": "aggregate", "groupby": ["Stroke_Value"]},
          {"type": "filter", "expr": "isValid(datum.Stroke_Value)"}
        ]
      },
      {
        "name": "cols_domain",
        "source": "tdata",
        "transform": [
          {"type": "aggregate", "groupby": ["Col_Value"]},
          {"type": "collect", "sort": {"field": "Col_Value"}},
          {"type": "formula", "as": "data", "expr": "datum['Col_Value']"}
        ]
      },
      {
        "name": "rows_domain",
        "source": "tdata",
        "transform": [
          {"type": "aggregate", "groupby": ["Row_Value"]},
          {"type": "collect", "sort": {"field": "Row_Value"}},
          {"type": "formula", "as": "data", "expr": "datum['Row_Value']"}
        ]
      },
      {
        "name": "graph_stackplots",
        "values": [1],
        "transform": [
          {"type": "filter", "expr": "show_stacked_graphs&&!Show_Covariance"}
        ]
      },
      {
        "name": "graph_covariance",
        "values": [1],
        "transform": [{"type": "filter", "expr": "Show_Covariance"}]
      },
      {
        "name": "show_variant_legends",
        "values": [1],
        "transform": [
          {"type": "filter", "expr": "show_explorer&&!Show_Covariance"}
        ]
      },
      {
        "name": "graph_boxplots",
        "values": [1],
        "transform": [
          {"type": "filter", "expr": "show_box_graphs&&!Show_Covariance"}
        ]
      },
      {
        "name": "graph_hzboxplots",
        "values": [1],
        "transform": [
          {"type": "filter", "expr": "show_hzbox_graphs&&!Show_Covariance"}
        ]
      },
      {
        "name": "graph_grids",
        "values": [1],
        "transform": [
          {"type": "filter", "expr": "show_grid_graphs&&!Show_Covariance"}
        ]
      },
      {
        "name": "graph_scatter",
        "values": [1],
        "transform": [
          {
            "type": "filter",
            "expr": "(show_scatter_graph||show_hist_graph)&&!Show_Covariance"
          }
        ]
      },
      {
        "name": "xcat_domain",
        "source": "tdata",
        "transform": [{"type": "aggregate", "groupby": ["X_Value"]}]
      },
      {
        "name": "ycat_domain",
        "source": "tdata",
        "transform": [{"type": "aggregate", "groupby": ["Y_Value"]}]
      },
      {
        "name": "run_correl",
        "values": [1],
        "transform": [
          {"type": "filter", "expr": "Regression_&show_scatter_graph"}
        ]
      }
    ],
    "scales": [
      {
        "name": "x_cont_log_scale",
        "type": "log",
        "round": true,
        "zero": false,
        "nice": true,
        "reverse": {"signal": "Reverse_X"},
        "domain": {"signal": "xdom"},
        "range": [{"signal": "0"}, {"signal": "Plot_Width"}]
      },
      {
        "name": "x_cont_scale",
        "type": "linear",
        "round": true,
        "zero": false,
        "reverse": {"signal": "Reverse_X"},
        "domain": {"signal": "xdom"},
        "range": [{"signal": "0"}, {"signal": "Plot_Width"}]
      },
      {
        "name": "y_cont_scale",
        "reverse": {"signal": "!Reverse_Y"},
        "type": "linear",
        "round": true,
        "domain": {"signal": "ydom"},
        "zero": false,
        "range": [0, {"signal": "if(show_box_graphs,Plot_Height,0)"}]
      },
      {
        "name": "y_cont_log_scale",
        "reverse": {"signal": "!Reverse_Y"},
        "type": "log",
        "round": true,
        "domain": {"signal": "ydom"},
        "zero": false,
        "range": [0, {"signal": "if(show_box_graphs,Plot_Height,0)"}]
      },
      {
        "name": "filter_scale",
        "type": "ordinal",
        "range": {"scheme": {"signal": "Palette"}},
        "domain": {
          "data": "mydata",
          "field": {"signal": "Filter_Out_From"},
          "sort": true
        }
      },
      {
        "name": "filter_scale2",
        "type": "ordinal",
        "range": {"scheme": {"signal": "Palette"}},
        "domain": {
          "data": "mydata",
          "field": {"signal": "Filter_Additional"},
          "sort": true
        }
      },
      {
        "name": "color_scale_cat",
        "type": "ordinal",
        "domain": {"data": "colors_domain", "sort": true, "field": "Color_Value"},
        "range": {"scheme": {"signal": "Palette"}}
      },
      {
        "name": "color_scale_cont",
        "type": "quantize",
        "nice": true,
        "range": {"scheme": {"signal": "Palette"}, "count": 20},
        "reverse": {"signal": "Reverse_Color"},
        "domain": [
          {
            "signal": "Min_Color!=''&Max_Color!=''?toNumber(Min_Color):C_maxmin_num[0]"
          },
          {
            "signal": "Min_Color!=''&Max_Color!=''?toNumber(Max_Color):C_maxmin_num[1]"
          }
        ]
      },
      {
        "name": "row_scale",
        "type": "band",
        "range": [
          {"signal": "PlotTitle_Height"},
          {"signal": "Row_Height*rows_count"}
        ],
        "domain": {"data": "rows_domain", "field": "data", "sort": true}
      },
      {
        "name": "col_scale",
        "type": "band",
        "range": [{"signal": "Row_Header_Width"}, {"signal": "width"}],
        "domain": {"data": "cols_domain", "field": "data", "sort": true}
      },
      {
        "name": "size_scale",
        "type": "pow",
        "exponent": 2,
        "round": true,
        "nice": true,
        "zero": false,
        "reverse": {"signal": "Reverse_Size"},
        "domain": [
          {"signal": "S_maxmin_num[0]"},
          {"signal": "S_maxmin_num[1]+(S_maxmin_num[1]-S_maxmin_num[0])*0.05"}
        ],
        "range": [
          {"signal": "Min_Point"},
          {"signal": "if(Size_By!='None',Max_Point,Min_Point)"}
        ]
      },
      {
        "name": "cat_color_scale",
        "type": "ordinal",
        "domain": {"field": "data", "data": "cols_domain"},
        "range": {"scheme": {"signal": "Palette"}}
      },
      {
        "name": "stroke_color_scale",
        "type": "ordinal",
        "domain": {"field": "Stroke_Value", "data": "stroke_domain"},
        "range": {"scheme": {"signal": "'sinebow'"}}
      }
    ],
    "marks": [
      {
        "type": "group",
        "interactive": true,
        "name": "title_graphs",
        "encode": {
          "update": {
            "height": {"signal": "Title_Height"},
            "x": {"signal": "margin_hz"},
            "width": {"signal": "width-margin_hz*2"},
            "y": {"signal": "0"}
          }
        },
        "title": {
          "text": {
            "signal": "if(!Show_Covariance,if(graph_title,graph_title+ ' by ','')+if(X_Axis!='None',X_Axis,'')+if(Y_Axis!='None',' vs. '+Y_Axis,''),'Covariance')"
          },
          "subtitle": {
            "signal": "if(!Show_Covariance,if(Facet_Cols_By!='None' && Facet_Rows_By!='None', if(Color_By!='None','Colored By: '+Color_By,'Graphs Split By: '+Facet_Cols_By +' & '+Facet_Rows_By),if(Facet_Cols_By!='None',' Graph Split By: '+Facet_Cols_By,'')+if(Facet_Rows_By!='None',' Graph Split By: '+Facet_Rows_By,'')+if(Color_By!='None','    Colored By: '+Color_By,'')),'')"
          },
          "dy": {"signal": "Title_Height"},
          "anchor": "middle"
        }
      },
      {
        "type": "group",
        "interactive": true,
        "name": "SCATTER",
        "from": {"data": "graph_scatter"},
        "marks": [
          {
            "type": "group",
            "interactive": true,
            "encode": {
              "update": {
                "height": {
                  "signal": "height-Title_Height-X_Axis_Height-Legend_Height"
                },
                "x": {"signal": "margin_hz"},
                "width": {"signal": "width-margin_hz*2"},
                "y": {"signal": "Title_Height"}
              }
            },
            "data": [
              {"name": "filtered_instance", "source": "tdata"},
              {
                "name": "row_instance",
                "source": "rows_domain",
                "transform": [
                  {
                    "type": "filter",
                    "expr": "show_scatter_graph||show_hist_graph"
                  }
                ]
              },
              {
                "name": "col_instance",
                "source": "cols_domain",
                "transform": [
                  {
                    "type": "filter",
                    "expr": "show_scatter_graph||show_hist_graph"
                  }
                ]
              }
            ],
            "scales": [
              {
                "name": "x_cont_scale",
                "type": "linear",
                "round": true,
                "zero": false,
                "reverse": {"signal": "Reverse_X"},
                "domain": {"signal": "xdom"},
                "range": [{"signal": "0"}, {"signal": "Plot_Width"}]
              },
              {
                "name": "y_cont_scatter_scale",
                "type": "linear",
                "zero": false,
                "round": true,
                "reverse": {"signal": "!Reverse_Y"},
                "domain": {"signal": "ydom"},
                "range": [
                  {"signal": "hist_graph_height"},
                  {"signal": "Plot_Height"}
                ]
              },
              {
                "name": "y_cont_scatter_log_scale",
                "type": "log",
                "zero": false,
                "round": true,
                "reverse": {"signal": "!Reverse_Y"},
                "domain": {"signal": "ydom"},
                "range": [
                  {"signal": "hist_graph_height"},
                  {"signal": "Plot_Height"}
                ]
              },
              {
                "name": "y_cont_scale2",
                "type": "linear",
                "zero": false,
                "round": true,
                "reverse": {"signal": "!Reverse_Y"},
                "domain": {"signal": "ydom"},
                "range": [{"signal": "0"}, {"signal": "scatter_graph_height"}]
              },
              {
                "name": "y_cont_log_scale2",
                "reverse": {"signal": "!Reverse_Y"},
                "type": "log",
                "round": true,
                "domain": {"signal": "ydom"},
                "zero": false,
                "range": [{"signal": "0"}, {"signal": "scatter_graph_height"}]
              }
            ],
            "marks": [
              {
                "name": "row_header",
                "clip": false,
                "type": "group",
                "from": {"data": "rows_domain"},
                "encode": {
                  "update": {
                    "height": {"signal": "Plot_Height"},
                    "width": {"signal": "Row_Header_Width"},
                    "y": {"field": "data", "scale": "row_scale"},
                    "x": {"signal": "Row_Header_Width-5"}
                  }
                },
                "scales": [],
                "axes": [
                  {
                    "scale": "y_cont_scatter_scale",
                    "gridScale": "x_cont_scale",
                    "domain": true,
                    "title": "title",
                    "tickCount": {"signal": "TickCount"},
                    "titleLimit": {"signal": "Row_Height"},
                    "titleBaseline": "bottom",
                    "titleAnchor": "middle",
                    "titleAlign": "center",
                    "offset": 0,
                    "format": "~s",
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(!LogY_&show_scatter_graph,if(Facet_Rows_By=='None',Y_Axis,parent.data),'')"
                          }
                        }
                      },
                      "labels": {
                        "update": {
                          "text": {
                            "signal": "!LogY_&show_scatter_graph?if(datum.value>10000,format(datum.value,'~s'),format(datum.value, ',')):''"
                          }
                        }
                      },
                      "ticks": {
                        "update": {
                          "strokeOpacity": {
                            "signal": "!LogY_&show_scatter_graph?1:0"
                          }
                        }
                      }
                    },
                    "orient": "left",
                    "labels": true
                  },
                  {
                    "scale": "y_cont_scatter_log_scale",
                    "gridScale": "x_cont_scale",
                    "domain": true,
                    "title": "title",
                    "tickCount": {"signal": "TickCount"},
                    "titleLimit": {"signal": "Row_Height"},
                    "titleBaseline": "bottom",
                    "titleAnchor": "middle",
                    "offset": 0,
                    "titleAlign": "center",
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(LogY_&show_scatter_graph,if(Facet_Rows_By=='None',Y_Axis,parent.data),'')"
                          }
                        }
                      },
                      "labels": {
                        "update": {
                          "text": {
                            "signal": "LogY_&show_scatter_graph?if(datum.value>10000,format(datum.value,'~s'),format(datum.value, ',')):''"
                          }
                        }
                      },
                      "ticks": {
                        "update": {
                          "strokeOpacity": {
                            "signal": "LogY_&show_scatter_graph?1:0"
                          }
                        }
                      }
                    },
                    "orient": "left",
                    "labels": true
                  }
                ]
              },
              {
                "name": "col_footer",
                "type": "group",
                "from": {"data": "cols_domain"},
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "height": {"signal": "X_Axis_Height"},
                    "x": {"signal": "datum.data", "scale": "col_scale"},
                    "y": {
                      "signal": "row_ht*rows_count-Plot_Padding+4+PlotTitle_Height"
                    }
                  }
                },
                "axes": [
                  {
                    "scale": "x_cont_scale",
                    "gridScale": "y_cont_scatter_scale",
                    "domain": true,
                    "zindex": 0,
                    "format": "~s",
                    "tickCount": {"signal": "TickCount"},
                    "title": "title",
                    "offset": {"signal": "-X_Axis_Height"},
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(!LogX_,if(Facet_Cols_By=='None',X_Axis,parent.data),'')"
                          },
                          "align": {"value": "center"}
                        }
                      },
                      "labels": {
                        "update": {
                          "angle": {"signal": "X_Axis_Angle"},
                          "text": {
                            "signal": "!LogX_?if(datum.value>10000,format(datum.value,'~s'),format(datum.value, ',')):''"
                          },
                          "align": {"value": "right"}
                        }
                      },
                      "ticks": {
                        "update": {"strokeOpacity": {"signal": "!LogX_?1:0"}}
                      }
                    },
                    "orient": "bottom",
                    "labels": true
                  },
                  {
                    "scale": "x_cont_log_scale",
                    "gridScale": "y_cont_scatter_scale",
                    "domain": true,
                    "zindex": 0,
                    "tickCount": {"signal": "TickCount"},
                    "title": "title",
                    "offset": {"signal": "-X_Axis_Height"},
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(LogX_,if(Facet_Cols_By=='None',X_Axis,parent.data),'')"
                          },
                          "align": {"value": "center"}
                        }
                      },
                      "labels": {
                        "update": {
                          "angle": {"signal": "X_Axis_Angle"},
                          "text": {
                            "signal": "LogX_&show_scatter_graph?if(datum.value>1000000,format(datum.value,'~s'),format(datum.value, '')):''"
                          },
                          "align": {"value": "right"}
                        }
                      },
                      "ticks": {
                        "update": {
                          "strokeOpacity": {
                            "signal": "LogX_&show_scatter_graph?1:0"
                          }
                        }
                      }
                    },
                    "orient": "bottom",
                    "labels": true
                  }
                ]
              },
              {
                "name": "MultiGraphs",
                "type": "group",
                "from": {
                  "facet": {
                    "name": "facet_data",
                    "data": "filtered_instance",
                    "groupby": ["Row_Value", "Col_Value"]
                  }
                },
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "x": {"signal": "datum['Col_Value']", "scale": "col_scale"},
                    "y": {"signal": "datum['Row_Value']", "scale": "row_scale"},
                    "height": {"signal": "Plot_Height"},
                    "fill": {"signal": "Background_Color"},
                    "stroke": {"value": "#ccc"},
                    "strokeWidth": {"signal": "Stroke_Width"}
                  }
                },
                "scales": [],
                "axes": [],
                "data": [
                  {
                    "name": "scatter_data",
                    "source": "facet_data",
                    "transform": [
                      {"type": "filter", "expr": "show_scatter_graph"}
                    ]
                  },
                  {
                    "name": "correl_data",
                    "source": "facet_data",
                    "transform": [
                      {"type": "filter", "expr": "Cord"},
                      {"type": "filter", "expr": "Regression_"},
                      {
                        "type": "regression",
                        "groupby": [
                          {
                            "signal": "if(colors_count<100 & Regression_,Color_By,'None')"
                          }
                        ],
                        "method": "linear",
                        "params": true,
                        "x": "X_Value",
                        "y": "Y_Value",
                        "as": ["u", "v"]
                      }
                    ]
                  },
                  {
                    "name": "run_hist",
                    "values": [1],
                    "transform": [{"type": "filter", "expr": "show_hist_graph"}]
                  },
                  {
                    "name": "run_contours_cat",
                    "values": [1],
                    "transform": [
                      {
                        "type": "filter",
                        "expr": "Contours_&show_scatter_graph&Cord"
                      }
                    ]
                  },
                  {
                    "name": "run_contours_cont",
                    "values": [1],
                    "transform": [
                      {
                        "type": "filter",
                        "expr": "Contours_&show_scatter_graph&!Cord"
                      }
                    ]
                  }
                ],
                "marks": [
                  {
                    "type": "group",
                    "name": "histogram_graph",
                    "clip": false,
                    "from": {"data": "run_hist"},
                    "interactive": true,
                    "scales": [],
                    "encode": {
                      "update": {
                        "strokeOpacity": {"value": 0},
                        "width": {"signal": "Plot_Width"},
                        "y": {"signal": "0"},
                        "x": {"signal": "0"},
                        "height": {"signal": "hist_graph_height"}
                      }
                    },
                    "marks": [
                      {
                        "type": "group",
                        "name": "histo",
                        "clip": true,
                        "encode": {
                          "update": {
                            "height": {"signal": "hist_graph_height"},
                            "width": {"signal": "Plot_Width"}
                          }
                        },
                        "scales": [
                          {
                            "name": "hist_graph_scale",
                            "type": "linear",
                            "range": [
                              {"signal": "hist_graph_height"},
                              {"signal": "0"}
                            ],
                            "round": true,
                            "nice": true,
                            "domain": {
                              "data": "histstackmarks_data",
                              "fields": ["y0", "y1"]
                            }
                          }
                        ],
                        "axes": [
                          {
                            "scale": "x_cont_scale",
                            "domain": false,
                            "grid": true,
                            "tickCount": {"signal": "TickCount"},
                            "orient": "bottom",
                            "gridScale": "hist_graph_scale",
                            "encode": {
                              "grid": {
                                "update": {
                                  "opacity": {
                                    "signal": "if(!show_scatter_graph&&Grids_,Grid_Opacity,0)"
                                  }
                                }
                              }
                            },
                            "ticks": false,
                            "labels": false
                          },
                          {
                            "scale": "hist_graph_scale",
                            "domain": false,
                            "grid": true,
                            "tickCount": {"signal": "TickCount-1"},
                            "orient": "left",
                            "ticks": false,
                            "title": "title",
                            "titleBaseline": "middle",
                            "titleAnchor": "middle",
                            "offset": 0,
                            "titleAlign": "center",
                            "labelAlign": "right",
                            "gridScale": "x_cont_scale",
                            "encode": {
                              "labels": {
                                "update": {
                                  "fillOpacity": {
                                    "signal": "if(!show_scatter_graph,1,0)"
                                  },
                                  "dx": {"signal": "if(!show_scatter_graph,0,0)"}
                                }
                              },
                              "grid": {
                                "update": {
                                  "opacity": {
                                    "signal": "if(!show_scatter_graph&&Grids_,Grid_Opacity,0)"
                                  }
                                }
                              },
                              "title": {
                                "update": {
                                  "text": {
                                    "signal": "if(show_hist_graph&!show_scatter_graph,Sum_By=='None'?'#':' of'+Sum_By,'')"
                                  }
                                }
                              },
                              "domain": {
                                "update": {
                                  "stroke": {
                                    "signal": "if(!show_scatter_graph,'#777','transparent')"
                                  }
                                }
                              }
                            },
                            "labels": true
                          }
                        ],
                        "data": [
                          {
                            "name": "histcounts_data",
                            "source": "facet_data",
                            "transform": [
                              {
                                "type": "bin",
                                "field": "X_Value",
                                "extent": {"signal": "xdom"},
                                "nice": false,
                                "maxbins": {"signal": "Histogram_Bins_Size"}
                              },
                              {"type": "filter", "expr": "show_hist_graph"},
                              {
                                "type": "aggregate",
                                "groupby": ["bin0", "bin1", "Color_Value"]
                              }
                            ]
                          },
                          {
                            "name": "histstackmarks_data",
                            "source": "histcounts_data",
                            "transform": [
                              {
                                "type": "stack",
                                "offset": "zero",
                                "groupby": ["bin0"],
                                "sort": {"field": "Color_Value"},
                                "field": "count"
                              }
                            ]
                          }
                        ],
                        "marks": [
                          {
                            "type": "group",
                            "from": {"data": "histstackmarks_data"},
                            "interactive": true,
                            "encode": {
                              "update": {
                                "y": {"scale": "hist_graph_scale", "field": "y0"},
                                "y2": {
                                  "scale": "hist_graph_scale",
                                  "field": "y1"
                                },
                                "x": {"scale": "x_cont_scale", "field": "bin0"},
                                "x2": {"scale": "x_cont_scale", "field": "bin1"},
                                "stroke": {"value": "aliceblue"},
                                "strokeWidth": {
                                  "signal": "if(Cord,Stroke_Width,0)"
                                },
                                "fillOpacity": {"signal": "0.7"},
                                "tooltip": {
                                  "signal": "{'count':datum.count,'bin':format(datum['bin0'],'0.2f')+'-'+format(datum['bin1'],'0.2f'),'Sub-group': ''+datum['Color_Value']}"
                                },
                                "fill": [
                                  {
                                    "test": "Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {
                                    "scale": "color_scale_cont",
                                    "field": "Color_Value"
                                  }
                                ]
                              }
                            }
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "group",
                    "name": "scatter_chart",
                    "style": "cell",
                    "zindex": 1,
                    "interactive": true,
                    "scales": [],
                    "data": [{
                            "name": "search_data_filter",
                            "source": "scatter_data",
                            "transform": [
                              {
                                "type": "filter",
                                "expr": "datum.Term==Term"
                              }
                            ]
                          }],
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "y": {"signal": "hist_graph_height"},
                        "height": {"signal": "scatter_graph_height"}
                      }
                    },
                    "axes": [
                      {
                        "scale": "y_cont_scale2",
                        "domain": false,
                        "grid": true,
                        "tickCount": {"signal": "TickCount"},
                        "orient": "left",
                        "ticks": false,
                        "gridScale": "x_cont_scale",
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(!LogY_&Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "labels": false
                      },
                      {
                        "scale": "y_cont_log_scale2",
                        "domain": false,
                        "grid": true,
                        "tickCount": {"signal": "TickCount"},
                        "orient": "left",
                        "ticks": false,
                        "gridScale": "x_cont_scale",
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(LogY_&Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "labels": false
                      },
                      {
                        "scale": "x_cont_log_scale",
                        "domain": false,
                        "grid": true,
                        "tickCount": {"signal": "TickCount"},
                        "orient": "bottom",
                        "gridScale": "y_cont_scale2",
                        "ticks": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(LogX_&Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "labels": false
                      },
                      {
                        "scale": "x_cont_scale",
                        "domain": false,
                        "grid": true,
                        "tickCount": {"signal": "TickCount"},
                        "orient": "bottom",
                        "gridScale": "y_cont_scale2",
                        "ticks": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(!LogX_&Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "labels": false
                      }
                    ],
                    "marks": [
  
                     
                      {
                        "name": "scatter_point_mark",
                        "type": "symbol",
                        "interactive": true,
                        "zindex": 0.8,
                        "clip": false,
                        "from": {"data": "scatter_data"},
                        "encode": {
                          "update": {
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "X_Value"
                              },
                              {"scale": "x_cont_scale", "field": "X_Value"}
                            ],
                            "y": [
                              {
                                "test": "LogY_",
                                "scale": "y_cont_log_scale2",
                                "field": "Y_Value"
                              },
                              {"scale": "y_cont_scale2", "field": "Y_Value"}
                            ],
                            "shape": {"signal": "Shape"},
                            "size": {
                              "field": "Size_Value",
                              "scale": "size_scale"
                            },
                            "href": {
                              "signal": "Link ? LinkURL+datum[LinkField] + LinkTail: false"
                            },
                            "fillOpacity": {"signal": "Opacity_"},
                            "tooltip": {"signal": "datum"},
                            "fill": [
                              {"test": "!Points_", "value": "transparent"},
                              {
                                "test": "Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {
                                "scale": "color_scale_cont",
                                "field": "Color_Value"
                              }
                            ],
                            "stroke": [
                              {
                                "test": "isValid(datum.Stroke_Value)",
                                "scale": "stroke_color_scale",
                                "field": "Stroke_Value"
                              },
                              {"value": "transparent"}
                            ],
                            "strokeOpacity": [
                              {
                                "test": "isValid(datum.Stroke_Value)&&Stroke_By!='None'",
                                "value": 1
                              },
                              {"value": 0}
                            ],
                            "strokeWidth": {"signal": "Stroke_Width"}
                          },
                          "hover": {
                            "size": {"value": 120},
                            "fill": {"value": "gold"}
                          }
                        }
                      } ,
                          {
                            "name": "scatter_point_mark_search",
                            "type": "symbol",
                            "interactive": true,
                            "zindex": 1,
                            "from": {"data": "search_data_filter"},
                            "encode": {
                              "update": {
                                "x": [
                                  {
                                    "test": "LogX_",
                                    "scale": "x_cont_log_scale",
                                    "field": "X_Value"
                                  },
                                  {"scale": "x_cont_scale", "field": "X_Value"}
                                ],
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale2",
                                    "field": "Y_Value"
                                  },
                                  {"scale": "y_cont_scale2", "field": "Y_Value"}
                                ],
                                "shape": {"signal": "Shape"},
                                "size": { "signal": "Max_Point*1.2"},
                                "href": {
                                  "signal": "Link ? LinkURL+datum[LinkField] + LinkTail: false"
                                },
                                "tooltip": {"signal": "datum"},
                                "fill":                               
                                  {"value": "gold"}
                                ,
                                "stroke":   {"value": "red"},
                                "strokeOpacity": {"value": 1},
                                "strokeWidth": {"value": 1}
                              },
                              "hover": {
                                "size": {"value": 120},
                                "fill": {"value": "gold"}
                              }
                            }
                          }               
                    ]
                  },
                  {
                    "type": "group",
                    "name": "contour_chart",
                    "style": "cell",
                    "from": {"data": "run_contours_cat"},
                    "zindex": 0,
                    "interactive": true,
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "y": {"signal": "hist_graph_height"},
                        "height": {"signal": "scatter_graph_height"}
                      }
                    },
                    "scales": [
                      {
                        "name": "colorscale_contour",
                        "type": "ordinal",
                        "domain": {
                          "data": "contour_facet_data",
                          "field": "Color_Value"
                        },
                        "range": {"scheme": {"signal": "Palette"}},
                        "reverse": {"signal": "Reverse_Color"}
                      }
                    ],
                    "data": [
                      {
                        "name": "contour_facet_data",
                        "source": "facet_data",
                        "transform": [
                          {
                            "type": "filter",
                            "expr": "Contours_&show_scatter_graph"
                          }
                        ]
                      },
                      {
                        "name": "density",
                        "source": "contour_facet_data",
                        "transform": [
                          {
                            "type": "filter",
                            "expr": "Contours_&show_scatter_graph"
                          },
                          {
                            "type": "kde2d",
                            "groupby": [
                              {
                                "signal": "if(colors_count<100 & Contours_,'Color_Value','None')"
                              }
                            ],
                            "size": [
                              {"signal": "Plot_Width"},
                              {"signal": "scatter_graph_height"}
                            ],
                            "x": {"expr": "scale('x_cont_scale', datum.X_Value)"},
                            "y": {
                              "expr": "scale('y_cont_scale2', datum.Y_Value)"
                            },
                            "bandwidth": {"signal": "[bandwidth, bandwidth]"},
                            "counts": {"signal": "true"}
                          }
                        ]
                      },
                      {
                        "name": "contours_data",
                        "source": "density",
                        "transform": [
                          {
                            "type": "filter",
                            "expr": "Contours_&show_scatter_graph"
                          },
                          {
                            "type": "isocontour",
                            "field": "grid",
                            "resolve": {"signal": "resolve"},
                            "levels": 3
                          },
                          {"type": "filter", "expr": "isValid(datum.Color_Value)"}
                        ]
                      }
                    ],
                    "marks": [
                      {
                        "type": "image",
                        "from": {"data": "density"},
                        "clip": true,
                        "encode": {
                          "update": {
                            "x": {"signal": "0"},
                            "y": {"signal": "0"},
                            "width": {
                              "signal": "if(Contours_ & show_scatter_graph,Plot_Width,0)"
                            },
                            "height": {
                              "signal": "if(Contours_ & show_scatter_graph,scatter_graph_height,0)"
                            },
                            "opacity": {
                              "signal": "if(Contours_,Contour_Opacity,0)"
                            },
                            "aspect": {"value": false}
                          }
                        },
                        "transform": [
                          {
                            "type": "heatmap",
                            "field": "datum.grid",
                            "resolve": {"signal": "resolve"},
                            "color": {
                              "expr": "if(Contours_ & show_scatter_graph,scale('color_scale_cat', datum.datum.Color_Value),'')"
                            }
                          }
                        ]
                      },
                      {
                        "type": "path",
                        "clip": true,
                        "from": {"data": "contours_data"},
                        "encode": {
                          "update": {
                            "strokeWidth": {"signal": "Stroke_Width"},
                            "strokeOpacity": {"signal": "Cnt_St_Opacity"},
                            "tooltip": {"signal": "datum"},
                            "stroke": {
                              "scale": "color_scale_cat",
                              "field": "Color_Value"
                            }
                          }
                        },
                        "transform": [
                          {"type": "geopath", "field": "datum.contour"}
                        ]
                      }
                    ]
                  },
                  {
                    "type": "group",
                    "name": "contour_chart_cont",
                    "style": "cell",
                    "zindex": 0,
                    "from": {"data": "run_contours_cont"},
                    "interactive": true,
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "y": {"signal": "hist_graph_height"},
                        "height": {"signal": "scatter_graph_height"}
                      }
                    },
                    "scales": [
                      {
                        "name": "colorscale_contour_cont",
                        "type": "linear",
                        "domain": {
                          "data": "contours_data",
                          "field": "contour.value"
                        },
                        "range": {"scheme": {"signal": "Palette"}},
                        "reverse": {"signal": "Reverse_Color"}
                      }
                    ],
                    "data": [
                      {
                        "name": "contour_facet_data",
                        "source": "facet_data",
                        "transform": [
                          {
                            "type": "filter",
                            "expr": "Contours_&show_scatter_graph"
                          }
                        ]
                      },
                      {
                        "name": "density",
                        "source": "contour_facet_data",
                        "transform": [
                          {
                            "type": "filter",
                            "expr": "Contours_&show_scatter_graph"
                          },
                          {
                            "type": "kde2d",
                            "groupby": ["None"],
                            "size": [
                              {"signal": "Plot_Width"},
                              {"signal": "scatter_graph_height"}
                            ],
                            "x": {"expr": "scale('x_cont_scale', datum.X_Value)"},
                            "y": {
                              "expr": "scale('y_cont_scale2', datum.Y_Value)"
                            },
                            "bandwidth": {"signal": "[bandwidth, bandwidth]"},
                            "counts": true
                          }
                        ]
                      },
                      {
                        "name": "contours_data",
                        "source": "density",
                        "transform": [
                          {
                            "type": "filter",
                            "expr": "Contours_&show_scatter_graph"
                          },
                          {
                            "type": "isocontour",
                            "field": "grid",
                            "smooth": true,
                            "levels": 5
                          }
                        ]
                      }
                    ],
                    "marks": [
                      {
                        "type": "path",
                        "clip": true,
                        "zindex": 0,
                        "from": {"data": "contours_data"},
                        "encode": {
                          "update": {
                            "strokeWidth": {"signal": "Stroke_Width"},
                            "strokeOpacity": {"signal": "Contour_Opacity"},
                            "stroke": {"value": "#ccc"},
                            "tooltip": {"signal": "datum"},
                            "fill": {
                              "scale": "colorscale_contour_cont",
                              "signal": "datum.contour.value"
                            },
                            "fillOpacity": {"signal": "Contour_Opacity"}
                          }
                        },
                        "transform": [
                          {"type": "geopath", "field": "datum.contour"}
                        ]
                      }
                    ]
                  },
                  {
                    "type": "group",
                    "name": "correlation",
                    "style": "cell",
                    "zindex": 1,
                    "from": {"data": "run_correl"},
                    "interactive": true,
                    "scales": [],
                    "data": [],
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "y": {"signal": "hist_graph_height"},
                        "height": {"signal": "scatter_graph_height"}
                      }
                    },
                    "marks": [
                      {
                        "type": "rule",
                        "name": "regression",
                        "clip": true,
                        "zindex": 1,
                        "from": {"data": "correl_data"},
                        "encode": {
                          "update": {
                            "x": {
                              "scale": "x_cont_scale",
                              "signal": "X_maxmin_num[0]"
                            },
                            "x2": {
                              "scale": "x_cont_scale",
                              "signal": "X_maxmin_num[1]"
                            },
                            "y": {
                              "scale": "y_cont_scale2",
                              "signal": "X_maxmin_num[0]*datum.coef[1]+datum.coef[0]"
                            },
                            "y2": {
                              "scale": "y_cont_scale2",
                              "signal": "X_maxmin_num[1]*datum.coef[1]+datum.coef[0]"
                            },
                            "interpolate": {"value": "linear"},
                            "tooltip": {
                              "signal": "'y='+format(datum['coef'][1],'.4f')+'x+'+format(datum['coef'][0],'.4f')+',(r2='+format(datum['rSquared'],'.4f')+')'"
                            },
                            "stroke": {
                              "signal": "datum.keys[0]",
                              "scale": "color_scale_cat"
                            },
                            "strokeWidth": {"signal": "2"}
                          }
                        }
                      },
                      {
                        "type": "text",
                        "name": "statistics",
                        "clip": true,
                        "interactive": true,
                        "from": {"data": "correl_data"},
                        "encode": {
                          "update": {
                            "text": {
                              "signal": "if(Stats_,' r2='+format(datum['rSquared'],'.4f')+'  m='+format(datum['coef'][1],'.4f')+'  b='+format(datum['coef'][0],'.4f'),'')"
                            },
                            "fontSize": {"value": 10},
                            "angle": {"value": 0},
                            "y": {
                              "signal": "min(scatter_graph_height-10,max(5,scale('y_cont_scale2',X_maxmin_num[0]*datum.coef[1]+datum.coef[0]-X_maxmin_num[0])/2+X_maxmin_num[0]))"
                            },
                            "tooltip": {"signal": "datum"},
                            "opacity": {"value": 0.5}
                          }
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "interactive": true,
        "name": "STACKED",
        "from": {"data": "graph_stackplots"},
        "marks": [
          {
            "type": "group",
            "name": "stack_graphs",
            "clip": false,
            "encode": {
              "update": {
                "height": {
                  "signal": "height-Title_Height-X_Axis_Height-Legend_Height"
                },
                "x": {"signal": "margin_hz"},
                "width": {"signal": "width-margin_hz*2"},
                "y": {"signal": "Title_Height"}
              }
            },
            "data": [
              {
                "name": "row_instance",
                "source": "rows_domain",
                "transform": [{"type": "filter", "expr": "show_stacked_graphs"}]
              },
              {
                "name": "col_instance",
                "source": "cols_domain",
                "transform": [{"type": "filter", "expr": "show_stacked_graphs"}]
              },
              {
                "name": "stacked_data",
                "source": "tdata",
                "transform": [
                  {"type": "filter", "expr": "!fail"},
                  {
                    "type": "filter",
                    "expr": "if(Filter_By_Value!='None',if(datum[Filter_By_Value]>=toNumber(filter_min)&datum[Filter_By_Value]<=toNumber(filter_max),true,false),true)"
                  },
                  {"type": "filter", "expr": "show_stacked_graphs"},
                  {
                    "type": "collect",
                    "sort": {"field": ["Row_Value", "Col_Value", "Color_Value"]}
                  }
                ]
              },
              {
                "name": "binned_stacked_data",
                "source": "stacked_data",
                "transform": [
                  {
                    "type": "aggregate",
                    "groupby": [
                      "X_Value",
                      "Color_Value",
                      "Col_Value",
                      "Row_Value"
                    ],
                    "ops": ["sum", "max"],
                    "fields": ["Count", "Stroke_Value"],
                    "as": ["sum_yield", "Stroke_Value"]
                  },
                  {
                    "type": "stack",
                    "groupby": ["X_Value", "Col_Value", "Row_Value"],
                    "field": "sum_yield",
                    "sort": {"field": ["sum_yield"], "order": ["descending"]},
                    "as": ["sum_yield_start", "sum_yield_end"],
                    "offset": "zero"
                  },
                  {
                    "type": "formula",
                    "as": "sorted_by",
                    "expr": "SortX_By!='None'?datum.SortX_Value:datum.sum_yield_end"
                  }
                ]
              },
              {
                "name": "faceted_stacked_domain",
                "source": "stacked_data",
                "transform": [{"type": "aggregate", "groupby": ["Col_Value"]}]
              },
              {
                "name": "binned_stacked_domain",
                "source": "stacked_data",
                "transform": [{"type": "aggregate", "groupby": ["X_Value"]}]
              }
            ],
            "scales": [
              {
                "name": "stacked_scale",
                "type": "linear",
                "domain": {
                  "data": "binned_stacked_data",
                  "fields": ["sum_yield_start", "sum_yield_end"]
                },
                "range": [
                  {"signal": "if(show_stacked_graphs,Plot_Height,0)"},
                  {"signal": "0"}
                ],
                "nice": true,
                "zero": true
              },
              {
                "name": "binned_scale",
                "type": "band",
                "domain": {
                  "data": "binned_stacked_data",
                  "field": "X_Value",
                  "sort": {
                    "op": "max",
                    "field": "sorted_by",
                    "order": "descending"
                  }
                },
                "range": [{"signal": "0"}, {"signal": "Plot_Width"}],
                "paddingInner": 0.1,
                "reverse": false,
                "paddingOuter": 0.05
              }
            ],
            "marks": [
              {
                "name": "row_header",
                "clip": false,
                "type": "group",
                "from": {"data": "rows_domain"},
                "encode": {
                  "update": {
                    "height": {"signal": "Plot_Height"},
                    "width": {"signal": "Row_Header_Width"},
                    "y": {"field": "data", "scale": "row_scale"},
                    "x": {"signal": "Row_Header_Width-5"}
                  }
                },
                "axes": [
                  {
                    "scale": "stacked_scale",
                    "gridScale": "binned_scale",
                    "domain": true,
                    "title": "title",
                    "tickCount": {"signal": "TickCount"},
                    "titleLimit": {"signal": "Row_Height"},
                    "titleBaseline": "bottom",
                    "titleAlign": "center",
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(Facet_Rows_By=='None',Sum_By=='None'?'Counts':' of '+Sum_By+' ','# '+parent.data)"
                          }
                        }
                      }
                    },
                    "orient": "left",
                    "labels": true
                  }
                ]
              },
              {
                "name": "col_footer",
                "type": "group",
                "from": {"data": "cols_domain"},
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "height": {"signal": "X_Axis_Height"},
                    "x": {"signal": "datum.data", "scale": "col_scale"},
                    "y": {
                      "signal": "row_ht*rows_count-Plot_Padding+4+PlotTitle_Height"
                    }
                  }
                },
                "axes": [
                  {
                    "scale": "binned_scale",
                    "gridScale": "stacked_scale",
                    "domain": true,
                    "zindex": 0,
                    "tickCount": {"signal": "TickCount"},
                    "title": "title",
                    "offset": {"signal": "-X_Axis_Height"},
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(Facet_Cols_By=='None',X_Axis,parent.data)"
                          },
                          "align": {"value": "center"}
                        }
                      },
                      "grid": {
                        "update": {
                          "strokeOpacity": {"signal": "if(Grids_,Grid_Opacity,0)"}
                        }
                      },
                      "labels": {
                        "update": {
                          "angle": {"signal": "X_Axis_Angle"},
                          "align": {"value": "right"}
                        }
                      }
                    },
                    "orient": "bottom",
                    "labels": true
                  }
                ]
              },
              {
                "name": "stacked_chart",
                "type": "group",
                "clip": false,
                "from": {
                  "facet": {
                    "data": "binned_stacked_data",
                    "name": "mystackfacet",
                    "groupby": ["Col_Value", "Row_Value"]
                  }
                },
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "x": {"signal": "datum['Col_Value']", "scale": "col_scale"},
                    "y": {"signal": "datum['Row_Value']", "scale": "row_scale"},
                    "height": {"signal": "Plot_Height"},
                    "fill": {"signal": "Background_Color"},
                    "stroke": {"value": "#ccc"},
                    "strokeWidth": {"signal": "Grids_"}
                  }
                },
                "scales": [],
                "marks": [
                  {
                    "name": "child_marks",
                    "interactive": true,
                    "clip": false,
                    "type": "rect",
                    "style": "cell",
                    "from": {"data": "mystackfacet"},
                    "encode": {
                      "update": {
                        "fill": [
                          {
                            "test": "datum[\"sum_yield\"] === null || isNaN(datum[\"sum_yield\"])",
                            "value": null
                          },
                          {"scale": "color_scale_cat", "field": "Color_Value"}
                        ],
                        "opacity": {"signal": "Opacity_"},
                        "tooltip": {"signal": "datum"},
                        "stroke": [
                          {
                            "test": "isValid(datum.Stroke_Value) && Stroke_By!='None'",
                            "scale": "stroke_color_scale",
                            "field": "Stroke_Value"
                          },
                          {"value": "333333b5"}
                        ],
                        "strokeWidth": {"signal": "Stroke_Width"},
                        "y2": {
                          "scale": "stacked_scale",
                          "field": "sum_yield_end"
                        },
                        "y": {
                          "scale": "stacked_scale",
                          "field": "sum_yield_start"
                        },
                        "x": {"scale": "binned_scale", "field": "X_Value"},
                        "width": {"scale": "binned_scale", "band": true}
                      }
                    }
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "interactive": true,
        "name": "BOXES",
        "from": {"data": "graph_boxplots"},
        "marks": [
          {
            "name": "box_graph_charting",
            "type": "group",
            "interactive": true,
            "encode": {
              "update": {
                "height": {
                  "signal": "height-Title_Height-X_Axis_Height-Legend_Height"
                },
                "x": {"signal": "margin_hz"},
                "width": {"signal": "width-margin_hz*2"},
                "y": {"signal": "Title_Height"}
              }
            },
            "data": [
              {
                "name": "boxplots_data",
                "source": "tdata",
                "transform": [
                  {"type": "filter", "expr": "!fail"},
                  {
                    "type": "filter",
                    "expr": "if(Filter_By_Value!='None',if(datum[Filter_By_Value]>=toNumber(filter_min)&datum[Filter_By_Value]<=toNumber(filter_max),true,false),true)"
                  }
                ]
              },
              {
                "name": "boxplots_instance",
                "source": "boxplots_data",
                "transform": [{"type": "filter", "expr": "show_box_graphs"}]
              },
              {
                "name": "run_jitter",
                "values": [1],
                "transform": [{"type": "filter", "expr": "Jitter_"}]
              }
            ],
            "signals": [
              {
                "name": "cols_count",
                "push": "outer",
                "on": [
                  {
                    "events": {"signal": "length(data('cols_domain'))"},
                    "update": "length(data('cols_domain'))"
                  }
                ]
              }
            ],
            "scales": [
              {
                "name": "bin_band_scale",
                "type": "band",
                "domain": {
                  "data": "xcat_domain",
                  "field": "X_Value",
                  "sort": true
                },
                "range": [0, {"signal": "Plot_Width"}]
              },
              {
                "name": "group_scale_violin",
                "type": "ordinal",
                "reverse": {"signal": "Reverse_Color"},
                "range": {"scheme": {"signal": "Palette"}},
                "domain": {"data": "boxplots_data", "field": "Color_Value"}
              }
            ],
            "marks": [
              {
                "name": "row_header",
                "clip": false,
                "type": "group",
                "from": {"data": "rows_domain"},
                "data": [
                  {
                    "name": "rows_slice",
                    "source": "boxplots_data",
                    "transform": [
                      {
                        "type": "filter",
                        "expr": "datum['Row_Value']==parent.data"
                      },
                      {
                        "type": "extent",
                        "field": "Y_Value",
                        "signal": "y_row_dom"
                      }
                    ]
                  }
                ],
                "encode": {
                  "update": {
                    "height": {"signal": "Plot_Height"},
                    "width": {"value": 0},
                    "y": {"field": "data", "scale": "row_scale"},
                    "x": {"signal": "0"}
                  }
                },
                "axes": [
                  {
                    "scale": "y_cont_scale",
                    "gridScale": "bin_band_scale",
                    "domain": true,
                    "format": "~s",
                    "title": "title",
                    "titleLimit": {"signal": "Row_Height"},
                    "labelLimit": {"signal": "Row_Header_Width"},
                    "titleBaseline": "bottom",
                    "titleAnchor": "middle",
                    "offset": {"signal": "-1*Row_Header_Width+5"},
                    "titleAlign": "center",
                    "tickCount": {"signal": "TickCount"},
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "LogY_?'':if(Facet_Rows_By=='None',Y_Axis,parent.data)"
                          }
                        }
                      },
                      "labels": {
                        "update": {
                          "text": {
                            "signal": "LogY_?'':if(datum.value>10000,format(datum.value,'~s'),format(datum.value, ','))"
                          }
                        }
                      },
                      "ticks": {
                        "update": {"strokeOpacity": {"signal": "LogY_?0:1"}}
                      }
                    },
                    "grid": false,
                    "orient": "left",
                    "labels": true
                  },
                  {
                    "scale": "y_cont_log_scale",
                    "gridScale": "bin_band_scale",
                    "domain": true,
                    "title": "title",
                    "offset": {"signal": "-1*Row_Header_Width+5"},
                    "titleLimit": {"signal": "Row_Height"},
                    "titleBaseline": "bottom",
                    "tickCount": {"signal": "TickCount"},
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "LogY_?if(Facet_Rows_By=='None','',parent.data):''"
                          }
                        }
                      },
                      "labels": {
                        "update": {
                          "text": {
                            "signal": "!LogY_?'':if(datum.value>1000000,format(datum.value,'~s'),format(datum.value, ','))"
                          }
                        }
                      },
                      "ticks": {
                        "update": {"strokeOpacity": {"signal": "!LogY_?0:1"}}
                      }
                    },
                    "grid": false,
                    "orient": "left",
                    "labels": true
                  }
                ],
                "scales": [
                  {
                    "name": "y_cont_scale",
                    "reverse": {"signal": "!Reverse_Y"},
                    "type": "linear",
                    "round": true,
                    "domain": {
                      "signal": "if(Facet_Rows_By=='None'||Uniform_YLim,ydom,y_row_dom)"
                    },
                    "zero": false,
                    "range": [0, {"signal": "if(show_box_graphs,Plot_Height,0)"}]
                  },
                  {
                    "name": "y_cont_log_scale",
                    "reverse": {"signal": "!Reverse_Y"},
                    "type": "log",
                    "round": true,
                    "domain": {
                      "signal": "if(Facet_Rows_By=='None'||Uniform_YLim,ydom,y_row_dom)"
                    },
                    "zero": false,
                    "range": [0, {"signal": "if(show_box_graphs,Plot_Height,0)"}]
                  }
                ],
                "marks": [
                  {
                    "name": "_chart",
                    "style": "cell",
                    "interactive": true,
                    "type": "group",
                    "from": {
                      "facet": {
                        "data": "rows_slice",
                        "name": "multigraph_facets",
                        "groupby": ["Col_Value"]
                      }
                    },
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "fill": {"signal": "Background_Color"},
                        "x": {
                          "signal": "datum['Col_Value']",
                          "scale": "col_scale"
                        },
                        "y": {
                          "signal": "datum['Row_Value']",
                          "scale": "row_scale"
                        },
                        "height": {"signal": "Plot_Height"}
                      }
                    },
                    "axes": [
                      {
                        "scale": "bin_band_scale",
                        "gridScale": "y_cont_scale",
                        "domain": false,
                        "zindex": 0,
                        "labels": false,
                        "grid": true,
                        "ticks": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "orient": "bottom"
                      },
                      {
                        "scale": "y_cont_scale",
                        "gridScale": "bin_band_scale",
                        "grid": true,
                        "ticks": false,
                        "domain": false,
                        "tickCount": {"signal": "TickCount"},
                        "zindex": 0,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_&!LogY_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "orient": "left",
                        "labels": false
                      },
                      {
                        "scale": "y_cont_log_scale",
                        "gridScale": "bin_band_scale",
                        "grid": true,
                        "ticks": false,
                        "domain": false,
                        "tickCount": {"signal": "TickCount"},
                        "zindex": 0,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_&LogY_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "orient": "left",
                        "labels": false
                      }
                    ],
                    "marks": [
                      {
                        "type": "group",
                        "clip": true,
                        "name": "violin_row_graphs",
                        "interactive": true,
                        "from": {
                          "facet": {
                            "data": "multigraph_facets",
                            "name": "category_data",
                            "groupby": ["X_Value"]
                          }
                        },
                        "sort": {"field": ["datum.X_Value"]},
                        "encode": {
                          "update": {
                            "xc": {
                              "scale": "bin_band_scale",
                              "field": "X_Value",
                              "band": 0.5
                            },
                            "width": {"signal": "viol_width"},
                            "height": {"signal": "Plot_Height"}
                          }
                        },
                        "data": [
                          {
                            "name": "clean_cat",
                            "source": "category_data",
                            "transform": [
                              {
                                "type": "filter",
                                "expr": "!isNaN(datum['Y_Value'])&&Violin_"
                              }
                            ]
                          },
                          {
                            "name": "density_data",
                            "transform": [
                              {
                                "type": "density",
                                "steps": {"signal": "steps"},
                                "distribution": {
                                  "function": "kde",
                                  "from": "clean_cat",
                                  "field": "Y_Value",
                                  "bandwidth": 0
                                }
                              },
                              {
                                "type": "stack",
                                "groupby": ["value"],
                                "field": "density",
                                "offset": "center",
                                "as": ["x0", "x2"]
                              },
                              {"type": "filter", "expr": "Violin_"}
                            ]
                          },
                          {
                            "name": "category_summary_data",
                            "source": "category_data",
                            "transform": [
                              {
                                "type": "aggregate",
                                "drop": true,
                                "fields": [
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "Y_Value",
                                  "X_Value",
                                  "Col_Value",
                                  "Size_Value",
                                  "Color_Value"
                                ],
                                "ops": [
                                  "min",
                                  "q1",
                                  "median",
                                  "q3",
                                  "max",
                                  "count",
                                  "mean",
                                  "stdev",
                                  "stderr",
                                  "variancep",
                                  "max",
                                  "max",
                                  "max",
                                  "max"
                                ],
                                "as": [
                                  "min",
                                  "q1",
                                  "median",
                                  "q3",
                                  "max",
                                  "count",
                                  "mean",
                                  "stdev",
                                  "stderr",
                                  "varp",
                                  "X_Value",
                                  "Col_Value",
                                  "Size_Value",
                                  "Color_Value"
                                ]
                              },
                              {
                                "type": "filter",
                                "expr": "datum['median'] != null"
                              },
                              {"type": "filter", "expr": "datum['count'] > 1"}
                            ]
                          }
                        ],
                        "scales": [
                          {
                            "name": "width_density_scale",
                            "type": "linear",
                            "range": [0, {"signal": "viol_width"}],
                            "domain": {"data": "density_data", "field": "x2"}
                          }
                        ],
                        "marks": [
                          {
                            "type": "area",
                            "name": "Violin_Mark",
                            "interactive": true,
                            "from": {"data": "density_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {
                                    "test": "Violin_ && Cord && Color_By!='None'",
                                    "scale": "color_scale_cat",
                                    "signal": "parent.X_Value"
                                  },
                                  {"test": "Violin_", "value": "#CCC"},
                                  {"test": "!Violin_", "value": "transparent"}
                                ],
                                "x": {
                                  "scale": "width_density_scale",
                                  "field": "x0"
                                },
                                "x2": {
                                  "scale": "width_density_scale",
                                  "field": "x2"
                                },
                                "interpolate": {"value": "natural"},
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "field": "value"
                                  },
                                  {"scale": "y_cont_scale", "field": "value"}
                                ],
                                "opacity": [
                                  {"test": "Violin_", "signal": "Violin_Opacity"},
                                  {"value": 0}
                                ],
                                "orient": {"value": "horizontal"}
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "interactive": true,
                            "name": "upper_iqr_l",
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {"test": "Boxplot_ && !Cord", "value": "#CCC"},
                                  {
                                    "test": "Boxplot_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {"test": "!Boxplot_", "value": "transparent"}
                                ],
                                "width": {"value": 10},
                                "height": {"value": 1},
                                "xc": {"signal": "viol_width / 2"},
                                "opacity": [
                                  {
                                    "test": "Boxplot_",
                                    "signal": "Boxplot_Opacity"
                                  },
                                  {"value": 0}
                                ],
                                "tooltip": {
                                  "signal": "{'Group':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "yc": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "min(datum.max,datum['q3']+1.5*(datum['q3']-datum['q1']))"
                                  },
                                  {
                                    "scale": "y_cont_scale",
                                    "signal": "min(datum.max,datum['q3']+1.5*(datum['q3']-datum['q1']))"
                                  }
                                ],
                                "y2": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "datum.q3"
                                  },
                                  {"scale": "y_cont_scale", "signal": "datum.q3"}
                                ]
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "interactive": true,
                            "name": "upper_iqr",
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {"test": "Boxplot_ && !Cord", "value": "#CCC"},
                                  {
                                    "test": "Boxplot_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {"test": "!Boxplot_", "value": "transparent"}
                                ],
                                "width": {"signal": "6"},
                                "xc": {"signal": "viol_width / 2"},
                                "opacity": [
                                  {
                                    "test": "Boxplot_",
                                    "signal": "Boxplot_Opacity"
                                  },
                                  {"value": 0}
                                ],
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "min(datum.max,datum['q3']+1.5*(datum['q3']-datum['q1']))"
                                  },
                                  {
                                    "scale": "y_cont_scale",
                                    "signal": "min(datum.max,datum['q3']+1.5*(datum['q3']-datum['q1']))"
                                  }
                                ],
                                "y2": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "datum.q3"
                                  },
                                  {"scale": "y_cont_scale", "signal": "datum.q3"}
                                ]
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "interactive": true,
                            "name": "lower_iqr_line",
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {"test": "Boxplot_ && !Cord", "value": "#CCC"},
                                  {
                                    "test": "Boxplot_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {"test": "!Boxplot_", "value": "transparent"}
                                ],
                                "width": {"value": 6},
                                "height": {"value": 1},
                                "xc": {"signal": "viol_width / 2"},
                                "opacity": [
                                  {
                                    "test": "Boxplot_",
                                    "signal": "Boxplot_Opacity"
                                  },
                                  {"value": 0}
                                ],
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "yc": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "max(datum.min,datum['q1']-1.5*(datum['q3']-datum['q1']))"
                                  },
                                  {
                                    "scale": "y_cont_scale",
                                    "signal": "max(datum.min,datum['q1']-1.5*(datum['q3']-datum['q1']))"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "interactive": true,
                            "name": "lower_iqr",
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {"test": "Boxplot_ && !Cord", "value": "#CCC"},
                                  {
                                    "test": "Boxplot_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {"test": "!Boxplot_", "value": "transparent"}
                                ],
                                "width": {"signal": "6"},
                                "xc": {"signal": "viol_width / 2"},
                                "opacity": [
                                  {
                                    "test": "Boxplot_",
                                    "signal": "Boxplot_Opacity"
                                  },
                                  {"value": 0}
                                ],
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "datum.q1"
                                  },
                                  {"scale": "y_cont_scale", "signal": "datum.q1"}
                                ],
                                "y2": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "max(datum.min,datum['q1']-1.5*(datum['q3']-datum['q1']))"
                                  },
                                  {
                                    "scale": "y_cont_scale",
                                    "signal": "max(datum.min,datum['q1']-1.5*(datum['q3']-datum['q1']))"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "name": "quartileboxes",
                            "interactive": true,
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {"test": "Boxplot_ && !Cord", "value": "#CCC"},
                                  {
                                    "test": "Boxplot_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {"test": "!Boxplot_", "value": "transparent"}
                                ],
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "co`rn`erRadius": {"value": 3},
                                "opacity": [
                                  {
                                    "test": "Boxplot_",
                                    "signal": "Boxplot_Opacity"
                                  },
                                  {"value": 0}
                                ],
                                "xc": {"signal": "viol_width / 2"},
                                "width": {"signal": "max(viol_width/2 / 2,10)"},
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "field": "q1"
                                  },
                                  {"scale": "y_cont_scale", "field": "q1"}
                                ],
                                "y2": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "field": "q3"
                                  },
                                  {"scale": "y_cont_scale", "field": "q3"}
                                ]
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "name": "barplots",
                            "interactive": true,
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "fill": [
                                  {"test": "Barplot_ && !Cord", "value": "#CCC"},
                                  {
                                    "test": "Barplot_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {"test": "!Barplot_", "value": "transparent"}
                                ],
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "cornerRadius": {"value": 3},
                                "opacity": [
                                  {"test": "Barplot_", "value": 1},
                                  {"value": 0}
                                ],
                                "xc": {"signal": "viol_width / 2"},
                                "width": {"signal": "viol_width / 2"},
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "signal": "ydom[0]"
                                  },
                                  {"scale": "y_cont_scale", "signal": "ydom[0]"}
                                ],
                                "y2": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "field": "mean"
                                  },
                                  {"scale": "y_cont_scale", "field": "mean"}
                                ]
                              }
                            }
                          },
                          {
                            "type": "rect",
                            "name": "Dashes_",
                            "interactive": true,
                            "from": {"data": "category_data"},
                            "encode": {
                              "update": {
                                "x": {"signal": "viol_width*(0.5-Dash_Width/2)"},
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "field": "Y_Value"
                                  },
                                  {"scale": "y_cont_scale", "field": "Y_Value"}
                                ],
                                "fill": [
                                  {
                                    "test": "Dashes_ && Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {
                                    "test": "Dashes_ && !Cord",
                                    "field": "Color_Value",
                                    "scale": "color_scale_cont"
                                  }
                                ],
                                "stroke": [
                                  {
                                    "test": "Stroke_By=='None'",
                                    "value": "transparent"
                                  },
                                  {
                                    "test": "Stroke_By!='None'",
                                    "scale": "stroke_color_scale",
                                    "field": "Stroke_Value"
                                  }
                                ],
                                "strokeWidth": {
                                  "signal": "Stroke_By=='None'?0:Stroke_Width"
                                },
                                "fillOpacity": {"signal": "Dash_Opacity"},
                                "height": {"signal": "Dash_Height"},
                                "cornerRadius": {"signal": "Dash_Radius"},
                                "width": {"signal": "viol_width*Dash_Width"},
                                "tooltip": {"signal": "datum"}
                              }
                            }
                          },
                          {
                            "type": "group",
                            "name": "jitter_dashes",
                            "interactive": true,
                            "encode": {
                              "update": {
                                "xc": {
                                  "scale": "bin_band_scale",
                                  "field": "X_Value",
                                  "band": 0.5
                                },
                                "width": {"signal": "viol_width"},
                                "height": {"signal": "Plot_Height"}
                              }
                            },
                            "from": {"data": "run_jitter"},
                            "marks": [
                              {
                                "type": "symbol",
                                "name": "mysymbols",
                                "interactive": true,
                                "from": {"data": "category_data"},
                                "transform": [
                                  {
                                    "type": "force",
                                    "iterations": 70,
                                    "restart": true,
                                    "static": {"signal": "true"},
                                    "forces": [
                                      {
                                        "force": "collide",
                                        "iterations": {"signal": "1"},
                                        "radius": {"signal": "Jitter_Radius"}
                                      },
                                      {
                                        "force": "x",
                                        "x": "xfocus",
                                        "strength": {"signal": "1"}
                                      },
                                      {
                                        "force": "y",
                                        "y": "yfocus",
                                        "strength": {"signal": "1"}
                                      }
                                    ]
                                  }
                                ],
                                "encode": {
                                  "update": {
                                    "xfocus": {"signal": "viol_width*0.5"},
                                    "yfocus": [
                                      {
                                        "test": "LogY_",
                                        "scale": "y_cont_log_scale",
                                        "field": "Y_Value"
                                      },
                                      {
                                        "scale": "y_cont_scale",
                                        "field": "Y_Value"
                                      }
                                    ],
                                    "fill": [
                                      {
                                        "test": "Jitter_ & Cord",
                                        "scale": "color_scale_cat",
                                        "field": "Color_Value"
                                      },
                                      {
                                        "field": "Color_Value",
                                        "scale": "color_scale_cont"
                                      }
                                    ],
                                    "size": {
                                      "field": "Size_Value",
                                      "scale": "size_scale"
                                    },
                                    "stroke": {"value": "transparent"},
                                    "shape": {"signal": "Shape"},
                                    "tooltip": {"signal": "datum"},
                                    "opacity": [
                                      {"test": "Jitter_", "signal": "Opacity_"},
                                      {"value": 0}
                                    ]
                                  }
                                }
                              }
                            ]
                          },
                          {
                            "type": "rect",
                            "name": "medianLine",
                            "interactive": true,
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "opacity": [
                                  {"test": "Boxplot_", "value": 1},
                                  {"value": 0}
                                ],
                                "fill": {"value": "aliceblue"},
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "xc": {"signal": "viol_width / 2"},
                                "width": {"signal": "max(viol_width/2 / 2,10)"},
                                "height": {"value": 2},
                                "y": [
                                  {
                                    "test": "LogY_",
                                    "scale": "y_cont_log_scale",
                                    "field": "mean"
                                  },
                                  {"scale": "y_cont_scale", "field": "mean"}
                                ]
                              }
                            }
                          },
                          {
                            "type": "text",
                            "name": "statistics",
                            "interactive": true,
                            "from": {"data": "category_summary_data"},
                            "encode": {
                              "update": {
                                "text": {
                                  "signal": "if(Stats_,' n='+datum.count+'  ='+format(datum['mean'],'.2f')+'  ='+format(datum['varp'],'.3f'),'')"
                                },
                                "fontSize": {"value": 10},
                                "angle": {"value": -90},
                                "xc": {"signal": "viol_width/4"},
                                "y": {"signal": "Plot_Height"},
                                "tooltip": {
                                  "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                                },
                                "opacity": {"value": 0.5}
                              }
                            }
                          },
                          {
                            "type": "group",
                            "name": "Outliers",
                            "interactive": true,
                            "data": [
                              {
                                "name": "MyOutliers_",
                                "source": "category_data",
                                "transform": [
                                  {
                                    "type": "lookup",
                                    "from": "category_summary_data",
                                    "key": "Y_Value",
                                    "fields": ["value"],
                                    "as": ["value"],
                                    "default": true
                                  },
                                  {
                                    "type": "filter",
                                    "expr": "datum['Y_Value'] >= (datum.value.q3-datum.value.q1)*2+datum.value.q3 || datum['Y_Value']<=datum.value.q1-(datum.value.q3-datum.value.q1)*2"
                                  }
                                ]
                              }
                            ],
                            "marks": [
                              {
                                "type": "symbol",
                                "name": "outlier_obs",
                                "interactive": true,
                                "from": {"data": "MyOutliers_"},
                                "encode": {
                                  "update": {
                                    "size": {"signal": "Max_Point"},
                                    "xc": {"signal": "viol_width / 2"},
                                    "y": [
                                      {
                                        "test": "LogY_",
                                        "scale": "y_cont_log_scale",
                                        "signal": "datum.Y_Value"
                                      },
                                      {
                                        "scale": "y_cont_scale",
                                        "signal": "datum.Y_Value"
                                      }
                                    ],
                                    "fill": {"value": "firebrick"},
                                    "tooltip": {"signal": "datum"},
                                    "opacity": [
                                      {"test": "Outliers_", "value": 0.5},
                                      {"value": 0}
                                    ]
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "name": "col_footer",
                "type": "group",
                "from": {"data": "cols_domain"},
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "height": {"signal": "X_Axis_Height"},
                    "x": {"signal": "datum.data", "scale": "col_scale"},
                    "y": {
                      "signal": "row_ht*rows_count-Plot_Padding+4+PlotTitle_Height"
                    }
                  }
                },
                "axes": [
                  {
                    "scale": "bin_band_scale",
                    "gridScale": "y_cont_scale",
                    "domain": true,
                    "zindex": 0,
                    "title": "title",
                    "labelAngle": -90,
                    "labelBaseline": "bottom",
                    "labelAlign": "right",
                    "labelLimit": {"signal": "X_Axis_Height-20"},
                    "offset": {"signal": "-X_Axis_Height"},
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(Facet_Cols_By=='None',X_Axis,parent.data)"
                          },
                          "align": {"value": "center"}
                        }
                      },
                      "labels": {
                        "update": {
                          "angle": {"signal": "X_Axis_Angle"},
                          "align": {"value": "right"}
                        }
                      }
                    },
                    "orient": "bottom",
                    "labels": true
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "interactive": true,
        "name": "HZBOXES",
        "from": {"data": "graph_hzboxplots"},
        "marks": [
          {
            "name": "box_graph_charting",
            "type": "group",
            "interactive": true,
            "encode": {
              "update": {
                "height": {
                  "signal": "height-Title_Height-X_Axis_Height-Legend_Height"
                },
                "x": {"signal": "margin_hz"},
                "width": {"signal": "width-margin_hz*2"},
                "y": {"signal": "Title_Height"}
              }
            },
            "data": [
              {
                "name": "boxplots_data",
                "source": "tdata",
                "transform": [
                  {"type": "filter", "expr": "!fail"},
                  {
                    "type": "filter",
                    "expr": "if(Filter_By_Value!='None',if(datum[Filter_By_Value]>=toNumber(filter_min)&datum[Filter_By_Value]<=toNumber(filter_max),true,false),true)"
                  }
                ]
              },
              {
                "name": "boxplots_instance",
                "source": "boxplots_data",
                "transform": [{"type": "filter", "expr": "show_hzbox_graphs"}]
              },
              {
                "name": "run_jitter",
                "values": [1],
                "transform": [{"type": "filter", "expr": "Jitter_"}]
              }
            ],
            "scales": [
              {
                "name": "x_cont_scale",
                "type": "linear",
                "round": true,
                "nice": true,
                "zero": false,
                "reverse": {"signal": "Reverse_X"},
                "domain": {"signal": "xdom"},
                "range": [{"signal": "0"}, {"signal": "Plot_Width"}]
              },
              {
                "name": "bin_band_scale",
                "type": "band",
                "domain": {
                  "data": "ycat_domain",
                  "field": "Y_Value",
                  "sort": true
                },
                "range": [0, {"signal": "Plot_Height"}]
              },
              {
                "name": "group_scale_violin",
                "type": "ordinal",
                "reverse": {"signal": "Reverse_Color"},
                "range": {"scheme": {"signal": "Palette"}},
                "domain": {"data": "boxplots_data", "field": "Color_Value"}
              }
            ],
            "marks": [
              {
                "name": "row_header",
                "clip": false,
                "type": "group",
                "from": {"data": "rows_domain"},
                "encode": {
                  "update": {
                    "height": {"signal": "Plot_Height"},
                    "width": {"signal": "0"},
                    "y": {"field": "data", "scale": "row_scale"},
                    "x": {"signal": "Row_Header_Width"}
                  }
                },
                "title": {
                  "text": {
                    "signal": "if(Facet_Rows_By=='None',Y_Axis!='None'?Y_Axis:'','')"
                  },
                  "orient": "left"
                },
                "axes": [
                  {
                    "scale": "bin_band_scale",
                    "gridScale": "x_cont_scale",
                    "domain": true,
                    "title": "title",
                    "titleLimit": {"signal": "Row_Height"},
                    "titleBaseline": "top",
                    "titleAnchor": "middle",
                    "titleAlign": "center",
                    "labelLimit": {"signal": "Row_Header_Width"},
                    "labelAngle": 0,
                    "labelBaseline": "bottom",
                    "labelAlign": "center",
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(Facet_Rows_By!='None',parent.data,'')"
                          },
                          "align": {"value": "center"}
                        }
                      },
                      "labels": {
                        "update": {
                          "angle": {"signal": "Y_Axis_Angle"},
                          "text": {
                            "signal": "datum.value!='None'?datum.value:''"
                          },
                          "align": {"value": "right"}
                        }
                      }
                    },
                    "orient": "left",
                    "labels": true
                  }
                ]
              },
              {
                "name": "col_footer",
                "type": "group",
                "from": {"data": "cols_domain"},
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "height": {"signal": "X_Axis_Height"},
                    "x": {"signal": "datum.data", "scale": "col_scale"},
                    "y": {
                      "signal": "row_ht*rows_count-Plot_Padding+4+PlotTitle_Height"
                    }
                  }
                },
                "axes": [
                  {
                    "scale": "x_cont_scale",
                    "gridScale": "bin_band_scale",
                    "domain": true,
                    "title": "title",
                    "titleLimit": {"signal": "Column_Width"},
                    "labelLimit": {"signal": "X_Axis_Height"},
                    "titleBaseline": "top",
                    "titleAnchor": "middle",
                    "offset": {"signal": "-X_Axis_Height"},
                    "titleAlign": "center",
                    "labelBaseline": "top",
                    "labelAlign": "right",
                    "tickCount": {"signal": "TickCount"},
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "LogX_?'':if(Facet_Rows_By=='None','',parent.data)"
                          }
                        }
                      },
                      "labels": {
                        "update": {
                          "text": {
                            "signal": "LogX_?'':if(datum.value>100000,format(datum.value,'~s'),format(datum.value, ','))"
                          },
                          "angle": {"signal": "X_Axis_Angle"}
                        }
                      },
                      "domain": {"update": {"opacity": {"signal": "LogX_?0:1"}}},
                      "ticks": {
                        "update": {"strokeOpacity": {"signal": "LogX_?0:1"}}
                      }
                    },
                    "grid": false,
                    "orient": "bottom",
                    "labels": true
                  },
                  {
                    "scale": "x_cont_log_scale",
                    "gridScale": "bin_band_scale",
                    "domain": true,
                    "title": "title",
                    "titleLimit": {"signal": "Column_Width"},
                    "labelLimit": {"signal": "X_Axis_Height"},
                    "titleBaseline": "top",
                    "titleAnchor": "middle",
                    "offset": {"signal": "-X_Axis_Height"},
                    "titleAlign": "center",
                    "labelBaseline": "top",
                    "labelAlign": "right",
                    "tickCount": {"signal": "TickCount"},
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "LogX_?if(Facet_Rows_By=='None','',parent.data):''"
                          }
                        }
                      },
                      "labels": {
                        "update": {
                          "text": {
                            "signal": "!LogX_?'':if(datum.value>1000000,format(datum.value,'~s'),format(datum.value, ''))"
                          },
                          "angle": {"signal": "X_Axis_Angle"}
                        }
                      },
                      "domain": {"update": {"opacity": {"signal": "!LogX_?0:1"}}},
                      "ticks": {
                        "update": {"strokeOpacity": {"signal": "!LogX_?0:1"}}
                      }
                    },
                    "grid": false,
                    "orient": "bottom",
                    "labels": true
                  }
                ]
              },
              {
                "name": "_chart",
                "style": "cell",
                "interactive": true,
                "type": "group",
                "from": {
                  "facet": {
                    "data": "boxplots_instance",
                    "name": "multigraph_facets",
                    "groupby": ["Col_Value", "Row_Value"]
                  }
                },
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "fill": {"signal": "Background_Color"},
                    "x": {"signal": "datum['Col_Value']", "scale": "col_scale"},
                    "y": {"signal": "datum['Row_Value']", "scale": "row_scale"},
                    "height": {"signal": "Plot_Height"}
                  }
                },
                "axes": [
                  {
                    "scale": "bin_band_scale",
                    "gridScale": "x_cont_scale",
                    "domain": false,
                    "zindex": 0,
                    "labels": false,
                    "grid": true,
                    "ticks": false,
                    "encode": {
                      "grid": {
                        "update": {
                          "strokeOpacity": {"signal": "if(Grids_,Grid_Opacity,0)"}
                        }
                      }
                    },
                    "orient": "left"
                  },
                  {
                    "scale": "x_cont_scale",
                    "gridScale": "bin_band_scale",
                    "grid": true,
                    "ticks": false,
                    "domain": false,
                    "tickCount": {"signal": "TickCount"},
                    "zindex": 0,
                    "encode": {
                      "grid": {
                        "update": {
                          "strokeOpacity": {
                            "signal": "if(Grids_&!LogX_,Grid_Opacity,0)"
                          }
                        }
                      }
                    },
                    "orient": "bottom",
                    "labels": false
                  },
                  {
                    "scale": "x_cont_log_scale",
                    "gridScale": "bin_band_scale",
                    "grid": true,
                    "ticks": false,
                    "domain": false,
                    "tickCount": {"signal": "TickCount"},
                    "zindex": 0,
                    "encode": {
                      "grid": {
                        "update": {
                          "strokeOpacity": {
                            "signal": "if(Grids_&LogX_,Grid_Opacity,0)"
                          }
                        }
                      }
                    },
                    "orient": "bottom",
                    "labels": false
                  }
                ],
                "marks": [
                  {
                    "type": "group",
                    "clip": true,
                    "name": "mygraphs",
                    "interactive": true,
                    "from": {
                      "facet": {
                        "data": "multigraph_facets",
                        "name": "category_data",
                        "groupby": ["Y_Value"]
                      }
                    },
                    "sort": {"field": ["datum.Y_Value"]},
                    "encode": {
                      "update": {
                        "yc": {
                          "scale": "bin_band_scale",
                          "field": "Y_Value",
                          "band": 0.5
                        },
                        "width": {"signal": "Plot_Width"},
                        "height": {"signal": "viol_ht"}
                      }
                    },
                    "data": [
                      {
                        "name": "clean_cat",
                        "source": "category_data",
                        "transform": [
                          {"type": "filter", "expr": "!isNaN(datum['X_Value'])"}
                        ]
                      },
                      {
                        "name": "density_data",
                        "transform": [
                          {
                            "type": "density",
                            "steps": {"signal": "steps"},
                            "distribution": {
                              "function": "kde",
                              "from": "clean_cat",
                              "field": "X_Value",
                              "bandwidth": 0
                            }
                          },
                          {
                            "type": "stack",
                            "groupby": ["value"],
                            "field": "density",
                            "offset": "center",
                            "as": ["y0", "y2"]
                          }
                        ]
                      },
                      {
                        "name": "category_summary_data",
                        "source": "category_data",
                        "transform": [
                          {
                            "type": "aggregate",
                            "drop": true,
                            "fields": [
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "X_Value",
                              "Col_Value",
                              "Size_Value",
                              "Color_Value"
                            ],
                            "ops": [
                              "min",
                              "q1",
                              "median",
                              "q3",
                              "max",
                              "count",
                              "mean",
                              "stdev",
                              "stderr",
                              "variancep",
                              "max",
                              "max",
                              "max"
                            ],
                            "as": [
                              "min",
                              "q1",
                              "median",
                              "q3",
                              "max",
                              "count",
                              "mean",
                              "stdev",
                              "stderr",
                              "varp",
                              "Col_Value",
                              "Size_Value",
                              "Color_Value"
                            ]
                          },
                          {"type": "filter", "expr": "datum['median'] != null"},
                          {"type": "filter", "expr": "datum['count'] > 1"}
                        ]
                      }
                    ],
                    "scales": [
                      {
                        "name": "height_density_scale",
                        "type": "linear",
                        "range": [0, {"signal": "viol_ht"}],
                        "domain": {"data": "density_data", "field": "y2"}
                      }
                    ],
                    "marks": [
                      {
                        "type": "area",
                        "name": "Violin_Mark",
                        "interactive": true,
                        "from": {"data": "density_data"},
                        "encode": {
                          "update": {
                            "fill": [
                              {
                                "test": "Violin_&& Color_By=='None'",
                                "value": "#CCC"
                              },
                              {
                                "test": "Violin_ && Cord",
                                "scale": "color_scale_cat",
                                "signal": "parent.Y_Value"
                              },
                              {"test": "!Violin_", "value": "transparent"}
                            ],
                            "y": {"scale": "height_density_scale", "field": "y0"},
                            "y2": {
                              "scale": "height_density_scale",
                              "field": "y2"
                            },
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                            },
                            "interpolate": {"value": "natural"},
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "value"
                              },
                              {"scale": "x_cont_scale", "field": "value"}
                            ],
                            "opacity": [
                              {"test": "Violin_", "signal": "Violin_Opacity"},
                              {"value": 0}
                            ],
                            "orient": {"value": "vertical"}
                          }
                        }
                      },
                      {
                        "type": "rect",
                        "name": "mystuff",
                        "interactive": true,
                        "from": {"data": "category_summary_data"},
                        "encode": {
                          "update": {
                            "fill": [
                              {"test": "Boxplot_ && !Cord", "value": "#DDD"},
                              {
                                "test": "Boxplot_ && Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {"test": "!Boxplot_", "value": "transparent"}
                            ],
                            "height": {"signal": "viol_ht / 12"},
                            "yc": {"signal": "viol_ht / 2"},
                            "opacity": [
                              {"test": "Boxplot_", "value": 1},
                              {"value": 0}
                            ],
                            "cornerRadius": {"value": 3},
                            "tooltip": {"signal": "datum"},
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "signal": "min(datum.max,datum['q3']+1.5*(datum['q3']-datum['q1']))"
                              },
                              {
                                "scale": "x_cont_scale",
                                "signal": "min(datum.max,datum['q3']+1.5*(datum['q3']-datum['q1']))"
                              }
                            ],
                            "x2": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "signal": "max(datum.min,datum['q1']-1.5*(datum['q3']-datum['q1']))"
                              },
                              {
                                "scale": "x_cont_scale",
                                "signal": "max(datum.min,datum['q1']-1.5*(datum['q3']-datum['q1']))"
                              }
                            ]
                          }
                        }
                      },
                      {
                        "type": "rect",
                        "name": "barplots",
                        "interactive": true,
                        "from": {"data": "category_summary_data"},
                        "encode": {
                          "update": {
                            "fill": [
                              {"test": "Barplot_ && !Cord", "value": "#CCC"},
                              {
                                "test": "Barplot_ && Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {"test": "!Barplot_", "value": "transparent"}
                            ],
                            "height": {"signal": "viol_ht / 2"},
                            "yc": {"signal": "viol_ht / 2"},
                            "opacity": [
                              {"test": "Boxplot_", "value": 1},
                              {"value": 0}
                            ],
                            "cornerRadius": {"value": 3},
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                            },
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "median"
                              },
                              {"scale": "x_cont_scale", "field": "median"}
                            ],
                            "x2": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "signal": "xdom[0]"
                              },
                              {"scale": "x_cont_scale", "signal": "xdom[0]"}
                            ]
                          }
                        }
                      },
                      {
                        "type": "rect",
                        "interactive": true,
                        "name": "quartileboxes",
                        "from": {"data": "category_summary_data"},
                        "encode": {
                          "update": {
                            "fill": [
                              {"test": "Boxplot_ && !Cord", "value": "#DDD"},
                              {
                                "test": "Boxplot_ && Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {"test": "!Boxplot_", "value": "transparent"}
                            ],
                            "height": {"signal": "viol_ht / 2"},
                            "yc": {"signal": "viol_ht / 2"},
                            "opacity": [
                              {"test": "Boxplot_", "value": 1},
                              {"value": 0}
                            ],
                            "cornerRadius": {"value": 3},
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                            },
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "q3"
                              },
                              {"scale": "x_cont_scale", "field": "q3"}
                            ],
                            "x2": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "q1"
                              },
                              {"scale": "x_cont_scale", "field": "q1"}
                            ]
                          }
                        }
                      },
                      {
                        "type": "rect",
                        "name": "violin_dashes",
                        "interactive": true,
                        "from": {"data": "category_data"},
                        "encode": {
                          "update": {
                            "y": {"signal": "viol_ht*(0.5-Dash_Width/2)"},
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "X_Value"
                              },
                              {"scale": "x_cont_scale", "field": "X_Value"}
                            ],
                            "fill": [
                              {
                                "test": "Dashes_ && Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {
                                "test": "Dashes_ && !Cord",
                                "field": "Color_Value",
                                "scale": "color_scale_cont"
                              }
                            ],
                            "fillOpacity": {"signal": "Opacity_"},
                            "width": {"signal": "Dash_Height"},
                            "cornerRadius": {"signal": "Dash_Radius"},
                            "height": {"signal": "viol_ht*Dash_Width"},
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                            }
                          }
                        }
                      },
                      {
                        "type": "group",
                        "name": "jitter_dashes",
                        "interactive": true,
                        "data": [
                          {
                            "name": "category_data_filtered",
                            "source": "category_data",
                            "transform": [
                              {"type": "filter", "expr": "Dashes_&Jitter_"}
                            ]
                          }
                        ],
                        "from": {"data": "run_jitter"},
                        "marks": [
                          {
                            "type": "symbol",
                            "name": "mysymbols",
                            "interactive": true,
                            "from": {"data": "category_data_filtered"},
                            "transform": [
                              {
                                "type": "force",
                                "iterations": 70,
                                "restart": false,
                                "static": {"signal": "true"},
                                "forces": [
                                  {
                                    "force": "collide",
                                    "iterations": {"signal": "1"},
                                    "radius": {"signal": "1"}
                                  },
                                  {
                                    "force": "x",
                                    "x": "xfocus",
                                    "strength": {"signal": "1"}
                                  },
                                  {
                                    "force": "y",
                                    "y": "yfocus",
                                    "strength": {"signal": "1"}
                                  }
                                ]
                              }
                            ],
                            "encode": {
                              "update": {
                                "yfocus": {"signal": "viol_ht*0.5"},
                                "xfocus": [
                                  {
                                    "test": "LogX_",
                                    "scale": "x_cont_log_scale",
                                    "field": "X_Value"
                                  },
                                  {"scale": "x_cont_scale", "field": "X_Value"}
                                ],
                                "fill": [
                                  {
                                    "test": "Dashes_ & Cord",
                                    "scale": "color_scale_cat",
                                    "field": "Color_Value"
                                  },
                                  {
                                    "field": "Color_Value",
                                    "scale": "color_scale_cont"
                                  }
                                ],
                                "size": {"signal": "Max_Point"},
                                "stroke": {"value": "transparent"},
                                "height": {"signal": "viol_ht*0.3"},
                                "shape": {"signal": "Shape"},
                                "tooltip": {"signal": "datum"},
                                "opacity": [
                                  {"test": "Dashes_", "signal": "Opacity_"},
                                  {"value": 0}
                                ]
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "rect",
                        "name": "medianLine",
                        "interactive": true,
                        "from": {"data": "category_summary_data"},
                        "encode": {
                          "update": {
                            "opacity": [
                              {"test": "Boxplot_", "value": 1},
                              {"value": 0}
                            ],
                            "fill": {"value": "aliceblue"},
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                            },
                            "yc": {"signal": "viol_ht / 2"},
                            "height": {"signal": "viol_ht / 2"},
                            "width": {"value": 2},
                            "x": [
                              {
                                "test": "LogX_",
                                "scale": "x_cont_log_scale",
                                "field": "median"
                              },
                              {"scale": "x_cont_scale", "field": "median"}
                            ]
                          }
                        }
                      },
                      {
                        "type": "text",
                        "name": "count",
                        "interactive": true,
                        "from": {"data": "category_summary_data"},
                        "encode": {
                          "update": {
                            "text": {
                              "signal": "if(Stats_,' n='+datum.count+'  u='+format(datum['mean'],'.2f')+'  s='+format(datum['varp'],'.3f'),'')"
                            },
                            "fontSize": {"value": 10},
                            "angle": {"value": -90},
                            "yc": {"signal": "viol_ht/4"},
                            "x": {"signal": "Plot_Width"},
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Col':datum['Col_Value'],'Row':datum['Row_Value'],'Median': format(datum['median'],''),'Max': format(datum['max'],''),'Min': format(datum['min'],''),'q1': format(datum['q1'],'0.3f'),'q3': format(datum['q3'],'0.3f'),'': format(datum['stdev'],'0.3f'),'': format(datum['mean'],'.3f'),'Count':datum['count'],'varp':format(datum['varp'],'.2f')}"
                            },
                            "opacity": {"value": 0.5}
                          }
                        }
                      },
                      {
                        "type": "group",
                        "name": "inset",
                        "interactive": true,
                        "data": [
                          {
                            "name": "MyOutliers_",
                            "source": "category_data",
                            "transform": [
                              {
                                "type": "lookup",
                                "from": "category_summary_data",
                                "key": "Y_Value",
                                "fields": ["value"],
                                "as": ["value"],
                                "default": true
                              },
                              {
                                "type": "filter",
                                "expr": "datum['X_Value'] >= (datum.value.q3-datum.value.q1)*2+datum.value.q3 || datum['Y_Value']<=datum.value.q1-(datum.value.q3-datum.value.q1)*2"
                              }
                            ]
                          }
                        ],
                        "marks": [
                          {
                            "type": "symbol",
                            "name": "outlier_obs",
                            "interactive": true,
                            "from": {"data": "MyOutliers_"},
                            "encode": {
                              "update": {
                                "size": {"signal": "Max_Point"},
                                "yc": {"signal": "viol_ht / 2"},
                                "x": [
                                  {
                                    "test": "LogX_",
                                    "scale": "x_cont_log_scale",
                                    "field": "median"
                                  },
                                  {"scale": "x_cont_scale", "field": "median"}
                                ],
                                "fill": {"value": "firebrick"},
                                "tooltip": {"signal": "datum"},
                                "opacity": [
                                  {"test": "Outliers_", "value": 0.5},
                                  {"value": 0}
                                ]
                              }
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "name": "GRIDS",
        "interactive": true,
        "from": {"data": "graph_grids"},
        "marks": [
          {
            "type": "group",
            "interactive": true,
            "name": "grid_graphs",
            "encode": {
              "update": {
                "height": {
                  "signal": "height-Title_Height-X_Axis_Height-Legend_Height"
                },
                "x": {"signal": "margin_hz"},
                "width": {"signal": "width-margin_hz*2"},
                "y": {"signal": "Title_Height"}
              }
            },
            "data": [
              {
                "name": "row_instance",
                "source": "rows_domain",
                "transform": [{"type": "filter", "expr": "show_grid_graphs"}]
              },
              {
                "name": "col_instance",
                "source": "cols_domain",
                "transform": [{"type": "filter", "expr": "show_grid_graphs"}]
              },
              {
                "name": "run_jitter",
                "values": [1],
                "transform": [{"type": "filter", "expr": "Jitter_"}]
              },
              {
                "name": "show_heat",
                "values": [1],
                "transform": [{"type": "filter", "expr": "!Jitter_"}]
              },
              {
                "name": "grid_data",
                "source": "tdata",
                "transform": [
                  {"type": "filter", "expr": "!fail"},
                  {"type": "filter", "expr": "show_grid_graphs"},
                  {
                    "type": "collect",
                    "sort": {"field": ["Size_value"], "order": ["descending"]}
                  }
                ]
              }
            ],
            "scales": [
              {
                "name": "gx_scale",
                "type": "band",
                "align": 0.5,
                "reverse": {"signal": "Reverse_X"},
                "domain": {"data": "grid_data", "field": "X_Value", "sort": true},
                "range": [0, {"signal": "Plot_Width"}]
              },
              {
                "name": "gy_scale",
                "reverse": {"signal": "Reverse_Y"},
                "type": "band",
                "domain": {"data": "grid_data", "field": "Y_Value", "sort": true},
                "range": [0, {"signal": "Plot_Height"}]
              },
              {
                "name": "size_scale_x",
                "type": "pow",
                "exponent": 2,
                "domain": {"data": "grid_data", "field": "Size_Value"},
                "range": [
                  {
                    "signal": "if(Size_By!='None',min(bandwidth('gx_scale')*0.05,bandwidth('gx_scale')*0.95),bandwidth('gx_scale')*0.95)"
                  },
                  {"signal": "bandwidth('gx_scale')*0.95"}
                ]
              },
              {
                "name": "size_scale_y",
                "type": "pow",
                "exponent": 2,
                "domain": {"data": "grid_data", "field": "Size_Value"},
                "range": [
                  {
                    "signal": "if(Size_By!='None',min(bandwidth('gx_scale')*0.05,bandwidth('gy_scale')*0.05),min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95))"
                  },
                  {
                    "signal": "min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95)"
                  }
                ]
              },
              {
                "name": "size_scale",
                "type": "pow",
                "exponent": 2,
                "domain": {"data": "grid_data", "field": "Size_Value"},
                "range": [
                  {
                    "signal": "if(Size_By!='None',min(bandwidth('gx_scale')*0.05,bandwidth('gy_scale')*0.05),min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95))"
                  },
                  {
                    "signal": "min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95)"
                  }
                ]
              }
            ],
            "marks": [
              {
                "name": "row_header",
                "clip": false,
                "type": "group",
                "from": {"data": "rows_domain"},
                "encode": {
                  "update": {
                    "height": {"signal": "Plot_Height"},
                    "width": {"signal": "0"},
                    "y": {"field": "data", "scale": "row_scale"},
                    "x": {"signal": "Row_Header_Width-5"}
                  }
                },
                "title": {
                  "text": {"signal": "if(Y_Axis=='None',Y_Axis,'')"},
                  "orient": "left"
                },
                "axes": [
                  {
                    "scale": "gy_scale",
                    "gridScale": "gx_scale",
                    "domain": true,
                    "title": "title",
                    "bandPosition": 0.5,
                    "titleBaseline": "bottom",
                    "titleAnchor": "middle",
                    "offset": 0,
                    "titleAlign": "center",
                    "titleLimit": {"signal": "Row_Height"},
                    "zindex": 0,
                    "encode": {
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(parent.data=='None',Y_Axis,parent.data)"
                          }
                        }
                      },
                      "grid": {
                        "update": {
                          "strokeOpacity": {"signal": "if(Grids_,Grid_Opacity,0)"}
                        }
                      }
                    },
                    "orient": "left",
                    "labels": true
                  }
                ]
              },
              {
                "name": "col_footer",
                "type": "group",
                "from": {"data": "cols_domain"},
                "encode": {
                  "update": {
                    "width": {"signal": "Plot_Width"},
                    "height": {"signal": "X_Axis_Height"},
                    "x": {"signal": "datum.data", "scale": "col_scale"},
                    "y": {
                      "signal": "row_ht*rows_count-Plot_Padding+4+PlotTitle_Height"
                    }
                  }
                },
                "axes": [
                  {
                    "scale": "gx_scale",
                    "gridScale": "gy_scale",
                    "domain": true,
                    "bandPosition": 0.5,
                    "zindex": 0,
                    "title": "title",
                    "labelAngle": -90,
                    "labelBaseline": "bottom",
                    "labelAlign": "right",
                    "labelLimit": {"signal": "X_Axis_Height-20"},
                    "offset": {"signal": "-X_Axis_Height"},
                    "encode": {
                      "grid": {
                        "update": {
                          "strokeOpacity": {"signal": "if(Grids_,Grid_Opacity,0)"}
                        }
                      },
                      "title": {
                        "update": {
                          "text": {
                            "signal": "if(Facet_Cols_By=='None',X_Axis,parent.data)"
                          },
                          "align": {"value": "center"}
                        }
                      },
                      "labels": {
                        "update": {
                          "angle": {"signal": "X_Axis_Angle"},
                          "align": {"value": "right"}
                        }
                      }
                    },
                    "orient": "bottom",
                    "labels": true
                  }
                ]
              },
              {
                "name": "grid_chart",
                "type": "group",
                "from": {
                  "facet": {
                    "data": "grid_data",
                    "name": "plategrid",
                    "groupby": ["Col_Value", "Row_Value"]
                  }
                },
                "marks": [
                  {
                    "name": "grid_chart",
                    "type": "group",
                    "from": {"data": "run_jitter"},
                    "axes": [
                      {
                        "scale": "gy_scale",
                        "domain": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "gridScale": "gx_scale",
                        "orient": "left",
                        "labels": false,
                        "ticks": false
                      },
                      {
                        "scale": "gx_scale",
                        "gridScale": "gy_scale",
                        "domain": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "orient": "bottom",
                        "labels": false,
                        "ticks": false
                      }
                    ],
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "x": {"signal": "parent.Col_Value", "scale": "col_scale"},
                        "y": {"signal": "parent.Row_Value", "scale": "row_scale"},
                        "height": {"signal": "Plot_Height"}
                      }
                    },
                    "scales": [],
                    "marks": [
                      {
                        "type": "rect",
                        "from": {"data": "plategrid"},
                        "transform": [
                          {
                            "type": "force",
                            "iterations": 100,
                            "restart": true,
                            "static": {"signal": "true"},
                            "forces": [
                              {
                                "force": "collide",
                                "iterations": {"signal": "1"},
                                "radius": {"signal": "Jitter_Radius"}
                              },
                              {
                                "force": "x",
                                "x": "xfocus",
                                "strength": {"signal": "1"}
                              },
                              {
                                "force": "y",
                                "y": "yfocus",
                                "strength": {"signal": "1"}
                              }
                            ]
                          }
                        ],
                        "encode": {
                          "update": {
                            "xfocus": [
                              {
                                "band": 0.5,
                                "scale": "gx_scale",
                                "field": "X_Value"
                              }
                            ],
                            "yfocus": {
                              "band": 0.5,
                              "scale": "gy_scale",
                              "field": "Y_Value"
                            },
                            "width": [
                              {"test": "Jitter_", "signal": "Jitter_Radius*1.8"},
                              {
                                "test": "!Grid_Spacing",
                                "scale": "size_scale",
                                "field": "Size_Value"
                              },
                              {"scale": "size_scale_x", "field": "Size_Value"}
                            ],
                            "height": [
                              {"test": "Jitter_", "signal": "Jitter_Radius*1.8"},
                              {
                                "scale": "size_scale",
                                "test": "!Grid_Spacing",
                                "field": "Size_Value"
                              },
                              {"scale": "size_scale_y", "field": "Size_Value"}
                            ],
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Y': datum['Y_Value'],'C':datum['Color_Value'],'Row':datum['Col_Value'],'Col':datum['Row_Value'],'Size':datum['Size_Value']}"
                            },
                            "cornerRadius": {"signal": "Jitter_Radius"},
                            "opacity": [{"signal": "Opacity_"}],
                            "fill": [
                              {
                                "test": "Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {
                                "scale": "color_scale_cont",
                                "field": "Color_Value"
                              }
                            ]
                          }
                        }
                      }
                    ]
                  },
                  {
                    "name": "heat_grid_chart",
                    "from": {"data": "show_heat"},
                    "type": "group",
                    "axes": [
                      {
                        "scale": "gy_scale",
                        "domain": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "gridScale": "gx_scale",
                        "orient": "left",
                        "labels": false,
                        "ticks": false
                      },
                      {
                        "scale": "gx_scale",
                        "gridScale": "gy_scale",
                        "domain": false,
                        "encode": {
                          "grid": {
                            "update": {
                              "strokeOpacity": {
                                "signal": "if(Grids_,Grid_Opacity,0)"
                              }
                            }
                          }
                        },
                        "orient": "bottom",
                        "labels": false,
                        "ticks": false
                      }
                    ],
                    "encode": {
                      "update": {
                        "width": {"signal": "Plot_Width"},
                        "x": {"signal": "parent.Col_Value", "scale": "col_scale"},
                        "y": {"signal": "parent.Row_Value", "scale": "row_scale"},
                        "height": {"signal": "Plot_Height"}
                      }
                    },
                    "scales": [],
                    "marks": [
                      {
                        "type": "rect",
                        "from": {"data": "plategrid"},
                        "encode": {
                          "update": {
                            "xc": {
                              "band": 0.5,
                              "scale": "gx_scale",
                              "field": "X_Value"
                            },
                            "yc": {
                              "band": 0.5,
                              "scale": "gy_scale",
                              "field": "Y_Value"
                            },
                            "width": {
                              "scale": "size_scale",
                              "field": "Size_Value"
                            },
                            "height": {
                              "scale": "size_scale",
                              "field": "Size_Value"
                            },
                            "tooltip": {
                              "signal": "{'X':datum['X_Value'],'Y': datum['Y_Value'],'C':datum['Color_Value'],'Row':datum['Col_Value'],'Col':datum['Row_Value'],'Size':datum['Size_Value']}"
                            },
                            "cornerRadius": {"signal": "Grid_Radius"},
                            "opacity": [{"signal": "Opacity_"}],
                            "fill": [
                              {
                                "test": "Cord",
                                "scale": "color_scale_cat",
                                "field": "Color_Value"
                              },
                              {
                                "scale": "color_scale_cont",
                                "field": "Color_Value"
                              }
                            ]
                          }
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "name": "Covariance_graphs",
        "interactive": true,
        "from": {"data": "graph_covariance"},
        "marks": [
          {
            "type": "group",
            "interactive": true,
            "name": "grid_graphs",
            "encode": {
              "update": {
                "height": {
                  "signal": "height-Title_Height-X_Axis_Height-Legend_Height"
                },
                "x": {"signal": "Row_Header_Width"},
                "width": {"signal": "width-Row_Header_Width"},
                "y": {"signal": "Title_Height"}
              }
            },
            "axes": [
              {
                "scale": "gy_scale",
                "gridScale": "gx_scale",
                "domain": true,
                "bandPosition": 0.5,
                "offset": 0,
                "zindex": 0,
                "encode": {
                  "grid": {
                    "update": {
                      "strokeOpacity": {"signal": "if(Grids_,Grid_Opacity,0)"}
                    }
                  }
                },
                "orient": "left",
                "labels": true
              },
              {
                "scale": "gx_scale",
                "gridScale": "gy_scale",
                "domain": true,
                "bandPosition": 0.5,
                "zindex": 0,
                "labelAngle": -90,
                "labelBaseline": "bottom",
                "labelAlign": "right",
                "labelLimit": {"signal": "X_Axis_Height"},
                "encode": {
                  "grid": {
                    "update": {
                      "strokeOpacity": {"signal": "if(Grids_,Grid_Opacity,0)"}
                    }
                  },
                  "labels": {
                    "update": {
                      "angle": {"signal": "X_Axis_Angle"},
                      "align": {"value": "right"}
                    }
                  }
                },
                "orient": "bottom",
                "labels": true
              }
            ],
            "scales": [
              {
                "name": "gx_scale",
                "type": "band",
                "align": 0.5,
                "reverse": {"signal": "Reverse_X"},
                "domain": {"data": "covariance", "field": "var1", "sort": true},
                "range": [0, {"signal": "width-Row_Header_Width"}]
              },
              {
                "name": "gy_scale",
                "reverse": {"signal": "Reverse_Y"},
                "type": "band",
                "domain": {"data": "covariance", "field": "var2", "sort": true},
                "range": [0, {"signal": "Plot_Height"}]
              },
              {
                "name": "size_scale_x",
                "type": "pow",
                "exponent": 2,
                "domain": {"data": "covariance", "field": "% Variance"},
                "range": [
                  {"signal": "0"},
                  {
                    "signal": "min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95)"
                  }
                ]
              },
              {
                "name": "size_scale_y",
                "type": "pow",
                "exponent": 2,
                "domain": {"data": "covariance", "field": "% Variance"},
                "range": [
                  {"signal": "0"},
                  {
                    "signal": "min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95)"
                  }
                ]
              },
              {
                "name": "size_scale",
                "type": "pow",
                "exponent": 2,
                "domain": {"data": "covariance", "field": "% Variance"},
                "range": [
                  {"signal": "0"},
                  {
                    "signal": "min(bandwidth('gx_scale')*0.95,bandwidth('gy_scale')*0.95)"
                  }
                ]
              },
              {
                "name": "color_scale_cont",
                "type": "quantize",
                "nice": true,
                "range": {"scheme": {"signal": "Palette"}, "count": 20},
                "domain": {"data": "covariance", "field": "% Variance"}
              }
            ],
            "marks": [
              {
                "type": "rect",
                "from": {"data": "covariance"},
                "encode": {
                  "update": {
                    "xc": {"band": 0.5, "scale": "gx_scale", "field": "var1"},
                    "yc": {"band": 0.5, "scale": "gy_scale", "field": "var2"},
                    "width": {"scale": "gx_scale", "band": 0.8},
                    "height": {"scale": "gy_scale", "band": 0.8},
                    "tooltip": {"signal": "datum"},
                    "cornerRadius": {"signal": "Grid_Radius"},
                    "opacity": [{"signal": "Opacity_"}],
                    "fill": [{"scale": "color_scale_cont", "field": "% Variance"}]
                  }
                }
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "name": "VARIANTLEGENDS",
        "from": {"data": "show_variant_legends"},
        "encode": {
          "update": {
            "x": {"value": 0},
            "y": {"value": 0},
            "height": {"signal": "width"},
            "width": {"signal": "width"}
          }
        },
        "marks": [
          {
            "type": "group",
            "name": "hist_preview",
            "data": [
              {
                "name": "filtered_data",
                "source": "mydata",
                "transform": [{"type": "filter", "expr": "show_explorer"}]
              },
              {"name": "row_columns", "source": "explorer_columns"},
              {
                "name": "hist_columns",
                "source": "explorer_columns",
                "transform": [{"type": "filter", "expr": "datum.type=='num'"}]
              },
              {
                "name": "stack_columns",
                "source": "explorer_columns",
                "transform": [{"type": "filter", "expr": "datum.type=='cat'"}]
              }
            ],
            "encode": {
              "update": {
                "x": {"value": 50},
                "y": {"value": 50},
                "height": {"signal": "width-50"},
                "width": {"signal": "width-50"}
              }
            },
            "scales": [
              {
                "name": "row_bands",
                "type": "band",
                "range": [0, {"signal": "width-50"}],
                "domain": {"field": "feature", "data": "row_columns"}
              }
            ],
            "marks": [
              {
                "type": "group",
                "interactive": true,
                "from": {"data": "hist_columns"},
                "title": {
                  "text": {"signal": "parent['feature']"},
                  "anchor": "start"
                },
                "encode": {
                  "update": {
                    "y": {"scale": "row_bands", "signal": "datum.feature"},
                    "x": {"signal": "0"},
                    "width": {"signal": "width-70"},
                    "height": {"signal": "bandwidth('row_bands')-30"}
                  }
                },
                "signals": [{"name": "t1", "update": "parent.data"}],
                "data": [
                  {
                    "name": "col_data",
                    "source": "filtered_data",
                    "transform": [
                      {
                        "type": "formula",
                        "as": "X",
                        "expr": "datum[parent.feature]"
                      },
                      {"type": "filter", "expr": "datum.X!='NA'"},
                      {"type": "extent", "field": "X", "signal": "col_maxmin_num"}
                    ]
                  },
                  {
                    "name": "binned",
                    "source": "col_data",
                    "transform": [
                      {
                        "type": "bin",
                        "field": "X",
                        "extent": {"signal": "col_maxmin_num"},
                        "anchor": {"signal": "0"},
                        "step": {
                          "signal": "(col_maxmin_num[1]-col_maxmin_num[0])/10"
                        },
                        "nice": false
                      },
                      {
                        "type": "aggregate",
                        "key": "bin0",
                        "groupby": ["bin0", "bin1"],
                        "fields": ["bin0"],
                        "ops": ["count"],
                        "as": ["count"]
                      }
                    ]
                  }
                ],
                "axes": [
                  {
                    "scale": "X_scale",
                    "gridScale": "Y_scale",
                    "offset": 0,
                    "labels": true,
                    "domain": true,
                    "encode": {
                      "labels": {
                        "update": {
                          "fontSize": {"value": 7},
                          "angle": {"value": -45}
                        }
                      }
                    },
                    "orient": "bottom"
                  },
                  {
                    "scale": "Y_scale",
                    "gridScale": "X_scale",
                    "offset": 0,
                    "labels": true,
                    "domain": true,
                    "tickCount": 3,
                    "encode": {
                      "labels": {
                        "update": {
                          "fontSize": {"value": 7},
                          "angle": {"value": -45}
                        }
                      }
                    },
                    "orient": "left"
                  }
                ],
                "scales": [
                  {
                    "name": "X_scale",
                    "type": "linear",
                    "zero": false,
                    "range": [{"signal": "0"}, {"signal": "width-50"}],
                    "domain": {"field": "X", "data": "col_data"}
                  },
                  {
                    "name": "Y_scale",
                    "type": "linear",
                    "reverse": true,
                    "range": {"signal": "[0,bandwidth('row_bands')-30]"},
                    "domain": {"field": "count", "data": "binned"}
                  }
                ],
                "marks": [
                  {
                    "type": "rect",
                    "from": {"data": "binned"},
                    "encode": {
                      "update": {
                        "x": {"scale": "X_scale", "field": "bin0"},
                        "x2": {"scale": "X_scale", "field": "bin1"},
                        "y": {"scale": "Y_scale", "field": "count"},
                        "y2": {"scale": "Y_scale", "value": 0},
                        "fill": {"value": "steelblue"}
                      },
                      "hover": {"fill": {"value": "firebrick"}}
                    }
                  },
                  {
                    "type": "rect",
                    "from": {"data": "col_data"},
                    "encode": {
                      "enter": {
                        "x": {"scale": "X_scale", "field": "u"},
                        "width": {"value": 1},
                        "y": {"value": 25, "offset": {"signal": "height"}},
                        "height": {"value": 5},
                        "fill": {"value": "steelblue"},
                        "fillOpacity": {"value": 0.4}
                      }
                    }
                  }
                ]
              },
              {
                "type": "group",
                "interactive": true,
                "from": {"data": "stack_columns"},
                "title": {
                  "text": {"signal": "parent['feature']"},
                  "anchor": "start"
                },
                "encode": {
                  "update": {
                    "y": {"scale": "row_bands", "signal": "datum.feature"},
                    "x": {"signal": "0"},
                    "width": {"signal": "width-70"},
                    "height": {"signal": "bandwidth('row_bands')-30"}
                  }
                },
                "signals": [{"name": "t1", "update": "parent.data"}],
                "data": [
                  {
                    "name": "col_data",
                    "source": "filtered_data",
                    "transform": [
                      {
                        "type": "formula",
                        "as": "X",
                        "expr": "datum[parent.feature]"
                      },
                      {"type": "filter", "expr": "datum.X!='NA'"},
                      {"type": "extent", "field": "X", "signal": "col_maxmin_num"}
                    ]
                  },
                  {
                    "name": "binned",
                    "source": "col_data",
                    "transform": [
                      {
                        "type": "stack",
                        "groupby": ["X"],
                        "field": "Count",
                        "sort": {"field": ["Count"], "order": ["descending"]},
                        "as": ["sum_yield_start", "count"],
                        "offset": "zero"
                      }
                    ]
                  }
                ],
                "axes": [
                  {
                    "scale": "X_scale",
                    "gridScale": "Y_scale",
                    "offset": 0,
                    "labels": true,
                    "domain": true,
                    "encode": {
                      "labels": {
                        "update": {
                          "fontSize": {"value": 8},
                          "angle": {"value": -45}
                        }
                      }
                    },
                    "orient": "bottom"
                  },
                  {
                    "scale": "Y_scale",
                    "gridScale": "X_scale",
                    "offset": 0,
                    "labels": true,
                    "domain": true,
                    "tickCount": 3,
                    "encode": {
                      "labels": {
                        "update": {
                          "fontSize": {"value": 7},
                          "angle": {"value": -45}
                        }
                      }
                    },
                    "orient": "left"
                  }
                ],
                "scales": [
                  {
                    "name": "X_scale",
                    "type": "band",
                    "range": [{"signal": "0"}, {"signal": "width-50"}],
                    "domain": {"field": "X", "data": "binned"}
                  },
                  {
                    "name": "Y_scale",
                    "type": "linear",
                    "reverse": true,
                    "range": {"signal": "[0,bandwidth('row_bands')-30]"},
                    "domain": {"field": "count", "data": "binned"}
                  }
                ],
                "marks": [
                  {
                    "type": "rect",
                    "from": {"data": "binned"},
                    "encode": {
                      "update": {
                        "x": {"scale": "X_scale", "field": "X"},
                        "width": {"scale": "X_scale", "band": 1, "offset": -1},
                        "y": {"scale": "Y_scale", "field": "count"},
                        "y2": {"scale": "Y_scale", "value": 0},
                        "fill": {"value": "steelblue"}
                      },
                      "hover": {"fill": {"value": "firebrick"}}
                    }
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type": "group",
        "name": "chart_footer",
        "encode": {
          "update": {
            "y": {"signal": "height-Legend_Height+6"},
            "height": {"signal": "Legend_Height"},
            "width": {"signal": "width-margin_hz*2"},
            "x": {"signal": "margin_hz"}
          }
        },
        "legends": [
          {
            "fill": "color_scale_cont",
            "type": "gradient",
            "strokeColor": {
              "signal": "if(!Cord&!Show_Covariance,'#ccc','transparent')"
            },
            "gradientThickness": {"signal": "if(!Cord&!Show_Covariance,10,0)"},
            "gradientLength": {"signal": "if(!Cord&!Show_Covariance,200,0)"},
            "labelLimit": {"signal": "if(!Cord&!Show_Covariance,26,0)"},
            "labelSeparation": 10,
            "direction": "horizontal",
            "orient": "bottom",
            "title": {
              "signal": "if((Show_Titles&!Cord&!Show_Covariance),'Color By '+Color_By,'')"
            },
            "tickCount": 2,
            "labelOpacity": {"signal": "if(!Cord&!Show_Covariance,1,0)"},
            "titleOrient": "top"
          },
          {
            "fill": "color_scale_cat",
            "orient": "bottom",
            "values": {"signal": "!Cord ? [] : 0"},
            "title": {
              "signal": "if(Show_Titles & !(Color_By=='None') & Cord,'Color ~ '+Color_By,'')"
            },
            "strokeColor": {
              "signal": "if(Cord&!(Color_By=='None'),'#ccc','transparent')"
            },
            "encode": {
              "symbols": {
                "interactive": true,
                "update": {
                  "opacity": [
                    {"test": "!(Color_By=='None') & Cord", "value": 1},
                    {"value": 0}
                  ]
                }
              },
              "labels": {
                "name": "filterLegendlab",
                "interactive": true,
                "update": {
                  "opacity": [
                    {"test": "!(Color_By=='None') & Cord", "value": 0.75},
                    {"value": 0}
                  ]
                }
              }
            }
          },
          {
            "stroke": "stroke_color_scale",
            "orient": "bottom",
            "values": {"signal": "!Stroke_By=='None' ? [] : 0"},
            "title": {
              "signal": "if(Show_Titles & !(Stroke_By=='None'),'Stroke ~ '+Stroke_By,'')"
            },
            "strokeColor": {
              "signal": "if(!(Stroke_By=='None'),'#ccc','transparent')"
            },
            "encode": {
              "symbols": {
                "interactive": true,
                "update": {
                  "opacity": [
                    {"test": "!(Stroke_By=='None') ", "value": 1},
                    {"value": 0}
                  ]
                }
              },
              "labels": {
                "name": "filterLegendlab",
                "interactive": true,
                "update": {
                  "opacity": [
                    {"test": "!(Stroke_By=='None')", "value": 0.75},
                    {"value": 0}
                  ]
                }
              }
            }
          },
          {
            "stroke": "filter_scale",
            "title": {
              "signal": "if(Show_Titles & Filter_Out_From!='None','Filter (Click To Toggle)','')"
            },
            "strokeColor": {
              "signal": "if(Filter_Out_From=='None','transparent','firebrick')"
            },
            "values": {"signal": "Filter_Out_From=='None' ? [] : 0"},
            "encode": {
              "symbols": {
                "name": "filterLegend",
                "interactive": true,
                "update": {
                  "strokeWidth": {"value": 0},
                  "opacity": [
                    {"test": "Filter_Out_From=='None'", "value": 0.5},
                    {
                      "test": "indata('selectedFilter', 'value', datum.value)",
                      "value": 0.15
                    },
                    {"value": 0.75}
                  ],
                  "fill": [
                    {"test": "Filter_Additional=='None'", "value": "transparent"},
                    {
                      "test": "indata('selectedFilter', 'value', datum.value)",
                      "signal": "'yelllow'"
                    },
                    {"signal": "datum.value", "scale": "filter_scale2"}
                  ],
                  "size": {"value": 64}
                }
              },
              "labels": {
                "name": "filterLegendlab",
                "values": {"signal": "Filter_Out_From=='None' ? [] : 0"},
                "interactive": true,
                "update": {
                  "opacity": [
                    {"test": "Filter_Out_From=='None'", "value": 0.5},
                    {
                      "test": "indata('selectedFilter', 'value', datum.value)",
                      "value": 0.15
                    },
                    {"value": 0.75}
                  ]
                }
              },
              "title": {
                "update": {
                  "opacity": [
                    {"test": "Show_Titles&Filter_Out_From=='None'", "value": 0.5},
                    {"value": 1}
                  ]
                }
              }
            },
            "orient": "bottom"
          },
          {
            "fill": "filter_scale2",
            "title": {
              "signal": "if(Show_Titles & Filter_Additional!='None','Filter (Click To Toggle)','')"
            },
            "strokeColor": {
              "signal": "if(Filter_Additional=='None','transparent','firebrick')"
            },
            "cornerRadius": {"value": 4},
            "padding": {"value": 3},
            "values": {"signal": "Filter_Additional=='None' ? [] : 0"},
            "encode": {
              "symbols": {
                "name": "filterLegend",
                "interactive": true,
                "update": {
                  "strokeWidth": {"value": 1},
                  "opacity": [
                    {"test": "Filter_Additional=='None'", "value": 1},
                    {
                      "test": "indata('selectedFilter2', 'value', datum.value)",
                      "value": 0.15
                    },
                    {"value": 0.75}
                  ],
                  "size": {"value": 64},
                  "fill": [
                    {"test": "Filter_Additional=='None'", "value": "transparent"},
                    {
                      "test": "indata('selectedFilter2', 'value', datum.value)",
                      "signal": "'yelllow'"
                    },
                    {"signal": "datum.value", "scale": "filter_scale2"}
                  ]
                }
              },
              "labels": {
                "name": "filterLegendlab",
                "values": {"signal": "Filter_Additional=='None' ? [] : 0"},
                "interactive": true,
                "update": {
                  "opacity": [
                    {"test": "Filter_Additional=='None'", "value": 0.5},
                    {
                      "test": "indata('selectedFilter2', 'value', datum.value)",
                      "value": 0.15
                    },
                    {"value": 0.75}
                  ]
                }
              },
              "title": {
                "update": {
                  "opacity": [
                    {"test": "Show_Titles&Filter_Additional=='None'", "value": 1},
                    {"value": 1}
                  ]
                }
              }
            },
            "orient": "bottom"
          }
        ]
      },
      {
        "type": "image",
        "clip": true,
        "encode": {
          "update": {
            "url": {
              "value": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAUCAYAAADoZO9yAAAACXBIWXMAAAsSAAALEgHS3X78AAADhklEQVRIx52WPagcVRTHf3fZ0sdbwYggTEam8CHCW0jQSt7Y+3iLIFgIGRuLabKlnZvWJpMUg91bQYKFxaYVkzcvlYZdGBtjijGTqWyCEwzaKMfC/yz3DfvWjwuXmXvuOfd8/c+51wEZMDazmC3DOZcAScfnnAuB0GN5DrgMFBvEY2BhZqUvZ2Zr3iEwBg42HNwfIXDQWy+AXeAU+Al4V0pHwL7oSK51zk2ATzq6c24MFGY2QYcZkMibTTPT18yMbgIzycban/Tp3vpL0bKefKF/pmKY+Er6E2g7oXMMCTfRPdq3oo082kgpY+DldOKcWzjnrDdb59xHSkF5Xt7MrGb7eBN4bGatJ9N2aRkKQKfAFeU16x3QerSM/z+eAhc98MeKJEAx0M9M35vy2meKBbbP/4XX20YpA0Za18JlAtQDr4xuS2GmKIyBP4FkL+TQlhSs3IyVi/+Dcr8K5/pOe6mszaymB5xSgFpIoPgm5y1b0toS82a5F/KOvDLhLNQ5sXdO0QNxIpnCA3RhZriudLywFcIKeyGHD77iCwH1mhQkwNGDR3z32nt87IfezNoN/aj0AerhI9Te3ynrGRIqLVMgsSUZcB24xiWbrRlXrvjx7s7B/VvP33j2ZNgCpE01y4Mo8YyYAxNFGqBMm2qRB1GoaIRyuk6baj7wjBjL49LMZsJId0i/bRc7L/7BsyfDq+qUtQfAqeQeeamYAuM8iEZeC5gqjcd5EIWDHph2gU+dc6UEupCOe4aMX3799/Uibaq5voXkOgcS7U396kybKkmbqkybKgYeA+HQu9D2gRvALeAHz8PrwIyVa7WOgSPg+w5LW0aWB9GsMzQPonpDU5wCrTMznHO1vPhAN+i6mdmSFjje0JzuPTzZObxz8wJpU7luIw+iAvhMc1fk20rTL8CpInFmDIWNi4rGC739kbtMYUte0UFdp10B9159+9fzIvGz0pkpekde0zzIg2iUNtWZShoK2QBfA795wPONwXtDJKqcD4HjDcaEwEuqhkkeRGOBPfHSGatXrcfAA+IbwMk5cyEFV9aSl2xe5BfuPzzZIQ+iWGkZK2Lvew7WHug75VNVEHkQzfMgSpysPTAz9w8vtAy46vOpJ5Sekljgm3b3kxzdV0PMvIb5tHtapE2VOIUsVO/YZkis98UZPhnTNa552lS1aKF3cdZd5Uima3xl2lQLgL8AuhbrS5ztOeEAAAAASUVORK5CYII="
            },
            "href": {"value": "https://itg.usc.edu"},
            "x": {"signal": "width-30"},
            "y": {"signal": "height-30"},
            "height": {"value": 20},
            "width": {"value": 30},
            "tooltip": {"signal": "'crossex library itg.usc.edu'"},
            "cursor": {"value": "pointer"},
            "opacity": {"value": 0.2}
          },
          "hover": {"opacity": {"value": 1}}
        }
      }
    ]
  }